[config] Loaded .env from: C:\Users\tmoscaliuc\Downloads\script\threat-investigator\threat-intel\backend\.env
[config] Settings loaded — VT key: SET
 
 -------------- celery-local-8000-20260228-021648@EXP-JFW2P34 v5.6.2 (recovery)
--- ***** ----- 
-- ******* ---- Windows-11-10.0.26200-SP0 2026-02-28 02:16:53
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         threat_intel:0x169a6f07320
- ** ---------- .> transport:   redis://127.0.0.1:6379/5
- ** ---------- .> results:     redis://127.0.0.1:6379/6
- *** --- * --- .> concurrency: 8 (thread)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> investigations   exchange=investigations(direct) key=investigations
                

[tasks]
  . tasks.process_batch
  . tasks.run_analysis
  . tasks.run_collector
  . tasks.run_investigation
  . tasks.watchlist_check

2026-02-28 02:18:56,733 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-02-28 02:18:56,734 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 02:18:56,737 INFO sqlalchemy.engine.Engine select current_schema()
2026-02-28 02:18:56,738 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 02:18:56,741 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-02-28 02:18:56,743 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 02:18:56,745 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:18:56,795 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 02:18:56,797 INFO sqlalchemy.engine.Engine [generated in 0.00280s] {'pk_1': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:18:56,804 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 02:18:56,807 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:18:56,808 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 02:18:56,809 INFO sqlalchemy.engine.Engine [cached since 0.01525s ago] {'pk_1': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:18:56,814 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 02:18:56,817 INFO sqlalchemy.engine.Engine [generated in 0.00153s] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 28, 0, 18, 56, 812994, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:18:56,821 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 02:19:12,341 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:19:12,343 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 02:19:12,344 INFO sqlalchemy.engine.Engine [cached since 15.55s ago] {'pk_1': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:19:12,350 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 02:19:12,352 INFO sqlalchemy.engine.Engine [cached since 15.54s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 28, 0, 19, 12, 348590, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:19:12,355 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 02:19:23,445 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:19:23,452 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 02:19:23,453 INFO sqlalchemy.engine.Engine [generated in 0.00156s] {'id': UUID('9e4779e7-9c10-4394-8981-c3c4dfc93eec'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'screenshot', 'artifact_name': 'screenshot_domain.png', 'sha256_hash': '6bf0023e25412daf84a1c3a397ce2c588eec25f56e5ecab14a8ad3111d73939c', 'content_type': 'image/png', 'size_bytes': 10403, 'storage_path': 'artifacts\\e07f6ace-681f-44b0-b09e-202b87489798\\screenshot_domain.png'}
2026-02-28 02:19:23,457 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 02:19:25,425 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:19:25,430 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 02:19:25,504 INFO sqlalchemy.engine.Engine [cached since 2.053s ago] {'id': UUID('cc3504d7-1c5e-462b-bbd4-6419e55af45f'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'js_analysis', 'artifact_name': 'network_capture.har', 'sha256_hash': '670851e8c6fde87b2efafe343d894377c21a14d5ff2092c11f85e2d7dac96259', 'content_type': 'application/json', 'size_bytes': 234, 'storage_path': 'artifacts\\e07f6ace-681f-44b0-b09e-202b87489798\\network_capture.har'}
2026-02-28 02:19:25,509 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 02:19:26,689 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:19:26,694 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 02:19:26,695 INFO sqlalchemy.engine.Engine [generated in 0.00097s] {'exc_id': 'e07f6ace-681f-44b0-b09e-202b87489798'}
2026-02-28 02:19:26,698 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 02:19:26,700 INFO sqlalchemy.engine.Engine [cached since 0.004793s ago] {'exc_id': 'e07f6ace-681f-44b0-b09e-202b87489798'}
2026-02-28 02:19:26,701 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 02:19:26,704 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:19:26,705 INFO sqlalchemy.engine.Engine 
                    SELECT DISTINCT i.domain
                    FROM investigations i
                    JOIN evidence e ON e.investigation_id = i.id
                    WHERE i.id != %(exc_id)s
                      AND i.state = 'concluded'
                      AND (e.evidence_json->'whois'->>'registrar' = %(registrar)s)
                    LIMIT 20
                
2026-02-28 02:19:26,706 INFO sqlalchemy.engine.Engine [generated in 0.00085s] {'exc_id': 'e07f6ace-681f-44b0-b09e-202b87489798', 'registrar': 'RESERVED-Internet Assigned Numbers Authority'}
2026-02-28 02:19:26,715 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 02:20:13,652 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:20:13,654 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 02:20:13,655 INFO sqlalchemy.engine.Engine [cached since 76.86s ago] {'pk_1': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:20:13,658 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 02:20:13,660 INFO sqlalchemy.engine.Engine [generated in 0.00150s] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 28, 0, 20, 13, 656932, tzinfo=datetime.timezone.utc), 'classification': 'inconclusive', 'confidence': 'low', 'risk_score': 30, 'recommended_action': 'investigate', 'investigations_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:20:13,667 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 02:20:13,667 INFO sqlalchemy.engine.Engine [generated in 0.00251s] {'id': UUID('fb0b12f9-cbe8-465b-a83b-aa6a99c20f04'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'evidence_json': '{"domain": "example.com", "observable_type": "domain", "investigation_id": "e07f6ace-681f-44b0-b09e-202b87489798", "target_domain": "example.com", "t ... (53674 characters truncated) ... 47, "browser_postprocessing": 12327, "infrastructure_correlation": 1233, "signals_and_gaps": 0, "report_generation": 46906, "analysis_total": 61281}}', 'signals': '[{"id": "sig_no_hsts", "category": "security_posture", "description": "No HSTS header present", "severity": "low", "evidence_refs": ["http.security_h ... (1519 characters truncated) ... n": "PhishTank: URL found in phishing database (pending verification)", "severity": "high", "evidence_refs": ["threat_feeds.phishtank.in_database"]}]', 'data_gaps': '[]', 'external_context': 'null'}
2026-02-28 02:20:13,675 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 02:20:13,675 INFO sqlalchemy.engine.Engine [generated in 0.00094s] {'id': UUID('1b3fdb04-23e2-4468-9079-2c50e759566d'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'iteration': 0, 'report_json': '{"classification": "inconclusive", "confidence": "low", "investigation_state": "concluded", "primary_reasoning": "Analyst timeout after 45s. Fallback ... (2325 characters truncated) ... . Correlate with internal telemetry (proxy, DNS, EDR) for real user impact. 3. Re-run investigation if infrastructure/content changes are observed."}', 'executive_summary': 'Observable: example.com (domain) Classification: INCONCLUSIVE (low confidence), risk 30/100. Registrar: RESERVED-Internet Assigned Numbers Authority. ... (4 characters truncated) ... ain age: 11155 days. Final URL observed: http://example.com/. Key evidence: VirusTotal: 0 malicious, 0 suspicious of 93; PhishTank match (unverified)', 'technical_narrative': 'Network and web telemetry show reachable=True, redirects=0, and JS activity 1 requests (0 external). Email posture is spoofability=none. Threat feeds: PhishTank=True (verified=False), OpenPhish=False, ThreatFox matches=0. Pipeline timings (ms): report_generation=None, browser_postprocessing=None.', 'recommendations': '1. Validate external feed matches (especially PhishTank/OpenPhish) with manual review. 2. Correlate with internal telemetry (proxy, DNS, EDR) for real user impact. 3. Re-run investigation if infrastructure/content changes are observed.'}
2026-02-28 02:20:13,681 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,682 INFO sqlalchemy.engine.Engine [generated in 0.00111s] {'id': UUID('bc9cd977-6c7a-4198-b658-b764a597ed01'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'tls', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 389, 'evidence_json': '{"meta": {"collector": "tls", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.839129Z", "completed_at": "2026-02-28T00: ... (558 characters truncated) ... , "is_self_signed": false, "chain_length": 1, "chain_issuers": [], "cert_sha256": "7a70788fe1f5a90e81f7acbdc16422cb6e5d764be8d0f4da9721ba9674aa8ba9"}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,685 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,685 INFO sqlalchemy.engine.Engine [cached since 0.004661s ago] {'id': UUID('8fe01de1-9c5e-4eee-9e79-ba15bab98e24'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'dns', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 514, 'evidence_json': '{"meta": {"collector": "dns", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.834839Z", "completed_at": "2026-02-28T00: ... (1212 characters truncated) ... ["_k2n1y4vw3qtb4skdx9e7dxt97qrmmq9", "v=spf1 -all"], "dmarc": "v=DMARC1;p=reject;sp=reject;adkim=s;aspf=s", "spf": "v=spf1 -all", "has_dnssec": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,686 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,688 INFO sqlalchemy.engine.Engine [cached since 0.007172s ago] {'id': UUID('cc96cbf0-3481-43c9-9980-b67efdd04f4e'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'asn', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 577, 'evidence_json': '{"meta": {"collector": "asn", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.841403Z", "completed_at": "2026-02-28T00: ... (243 characters truncated) ... c.", "country": "Canada", "city": "Toronto", "is_cdn": true, "is_cloud": false, "is_hosting": true, "reverse_dns": "", "related_domains_same_ip": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,689 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,690 INFO sqlalchemy.engine.Engine [cached since 0.00981s ago] {'id': UUID('2a779c3f-b6cc-467f-befe-aa1aeea2674e'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'whois', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1514, 'evidence_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.839701Z", "completed_at": "2026-02-28T0 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,692 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,693 INFO sqlalchemy.engine.Engine [cached since 0.01233s ago] {'id': UUID('faf24d56-97df-4984-8dc6-a79aab7033c8'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'http', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1764, 'evidence_json': '{"meta": {"collector": "http", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.836979Z", "completed_at": "2026-02-28T00 ... (793 characters truncated) ...  false, "technologies_detected": ["Cloudflare"], "security_headers": {}, "brand_indicators": [], "phishing_indicators": [], "external_resources": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,695 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,695 INFO sqlalchemy.engine.Engine [cached since 0.01508s ago] {'id': UUID('2ba17d22-6ee2-48dc-8a79-29efaa6b903c'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1985, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.985162Z", "completed_at": "2026-02-28T00:1 ... (10211 characters truncated) ... ubject": "example.com", "vt_registrar": "RESERVED-Internet Assigned Numbers Authority", "tags": [], "notes": [], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,698 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,699 INFO sqlalchemy.engine.Engine [cached since 0.0186s ago] {'id': UUID('a4ef6d6d-5a82-40b5-8688-66ae57a39da8'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'threat_feeds', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 2641, 'evidence_json': '{"meta": {"collector": "threat_feeds", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:57.018002Z", "completed_at": "2026- ... (579 characters truncated) ... matches": [], "openphish_listed": false, "feeds_checked": ["abuseipdb", "phishtank", "openphish"], "feeds_skipped": ["threatfox (error: HTTPError)"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,707 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 02:20:13,708 INFO sqlalchemy.engine.Engine [cached since 0.02748s ago] {'id': UUID('0b6333f8-b158-4fe3-92b9-32caf602a493'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'collector_name': 'intel', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 15483, 'evidence_json': '{"meta": {"collector": "intel", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.842492Z", "completed_at": "2026-02-28T0 ... (12400 characters truncated) ... , "not_before": "2023-01-27T01:21:18", "not_after": "2033-01-24T01:21:18", "entry_timestamp": null, "name_value": "example.com\\nuser@example.com"}]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 02:20:13,711 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 02:20:13,712 INFO sqlalchemy.engine.Engine [generated in 0.00075s] {'id': UUID('1e609414-e27a-41fe-8402-897cbe190395'), 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'type': 'ip', 'value': '104.18.27.120', 'context': 'AbuseIPDB lookup target', 'confidence': 'medium'}
2026-02-28 02:20:13,715 INFO sqlalchemy.engine.Engine SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = %(domain_1)s ORDER BY whois_history.captured_at DESC 
 LIMIT %(param_1)s
2026-02-28 02:20:13,716 INFO sqlalchemy.engine.Engine [generated in 0.00064s] {'domain_1': 'example.com', 'param_1': 1}
2026-02-28 02:20:13,719 INFO sqlalchemy.engine.Engine INSERT INTO whois_history (id, domain, whois_json, investigation_id, changes_from_previous) VALUES (%(id)s::UUID, %(domain)s, %(whois_json)s::JSONB, %(investigation_id)s::UUID, %(changes_from_previous)s::JSONB) RETURNING whois_history.captured_at
2026-02-28 02:20:13,720 INFO sqlalchemy.engine.Engine [generated in 0.00157s] {'id': UUID('45d79bdf-ba53-4993-98be-7195443bccec'), 'domain': 'example.com', 'whois_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T00:18:56.839701Z", "completed_at": "2026-02-28T0 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'investigation_id': UUID('e07f6ace-681f-44b0-b09e-202b87489798'), 'changes_from_previous': '{}'}
2026-02-28 02:20:13,723 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 02:20:13,725 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 02:20:13,727 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 02:20:13,728 INFO sqlalchemy.engine.Engine [generated in 0.00099s] {'pk_1': UUID('e07f6ace-681f-44b0-b09e-202b87489798')}
2026-02-28 02:20:13,732 INFO sqlalchemy.engine.Engine SELECT clients.id, clients.name, clients.domain, clients.aliases, clients.brand_keywords, clients.contact_email, clients.notes, clients.status, clients.created_at, clients.alert_count, clients.last_alert_at, clients.default_collectors 
FROM clients 
WHERE clients.status = %(status_1)s
2026-02-28 02:20:13,732 INFO sqlalchemy.engine.Engine [generated in 0.00073s] {'status_1': 'active'}
2026-02-28 02:20:13,734 INFO sqlalchemy.engine.Engine ROLLBACK
