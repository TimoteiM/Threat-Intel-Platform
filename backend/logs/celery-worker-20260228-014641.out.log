[config] Loaded .env from: C:\Users\tmoscaliuc\Downloads\script\threat-investigator\threat-intel\backend\.env
[config] Settings loaded — VT key: SET
 
 -------------- celery-local-8000-20260228-014641@EXP-JFW2P34 v5.6.2 (recovery)
--- ***** ----- 
-- ******* ---- Windows-11-10.0.26200-SP0 2026-02-28 01:46:46
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         threat_intel:0x20ba83940b0
- ** ---------- .> transport:   redis://127.0.0.1:6379/5
- ** ---------- .> results:     redis://127.0.0.1:6379/6
- *** --- * --- .> concurrency: 8 (thread)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> investigations   exchange=investigations(direct) key=investigations
                

[tasks]
  . tasks.process_batch
  . tasks.run_analysis
  . tasks.run_collector
  . tasks.run_investigation
  . tasks.watchlist_check

2026-02-28 01:48:48,397 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-02-28 01:48:48,398 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 01:48:48,401 INFO sqlalchemy.engine.Engine select current_schema()
2026-02-28 01:48:48,402 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 01:48:48,404 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-02-28 01:48:48,405 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 01:48:48,407 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:48:48,457 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:48:48,459 INFO sqlalchemy.engine.Engine [generated in 0.00155s] {'pk_1': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:48:48,468 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:48:48,472 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:48:48,474 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:48:48,475 INFO sqlalchemy.engine.Engine [cached since 0.01724s ago] {'pk_1': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:48:48,481 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:48:48,484 INFO sqlalchemy.engine.Engine [generated in 0.00232s] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 27, 23, 48, 48, 479681, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:48:48,488 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:48:52,477 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:48:52,477 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:48:52,480 INFO sqlalchemy.engine.Engine [cached since 4.022s ago] {'pk_1': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:48:52,486 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:48:52,489 INFO sqlalchemy.engine.Engine [cached since 4.007s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 27, 23, 48, 52, 484153, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:48:52,491 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:49:02,012 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:02,018 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 01:49:02,019 INFO sqlalchemy.engine.Engine [generated in 0.00115s] {'id': UUID('7a01e836-feef-4e24-926c-8ba5cbe07acb'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'screenshot', 'artifact_name': 'screenshot_domain.png', 'sha256_hash': '6bf0023e25412daf84a1c3a397ce2c588eec25f56e5ecab14a8ad3111d73939c', 'content_type': 'image/png', 'size_bytes': 10403, 'storage_path': 'artifacts\\8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff\\screenshot_domain.png'}
2026-02-28 01:49:02,025 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:49:04,284 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:04,285 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 01:49:04,286 INFO sqlalchemy.engine.Engine [cached since 2.268s ago] {'id': UUID('e99c6ec1-b004-4205-b61d-293d21b3ea1f'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'js_analysis', 'artifact_name': 'network_capture.har', 'sha256_hash': '670851e8c6fde87b2efafe343d894377c21a14d5ff2092c11f85e2d7dac96259', 'content_type': 'application/json', 'size_bytes': 234, 'storage_path': 'artifacts\\8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff\\network_capture.har'}
2026-02-28 01:49:04,289 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:49:05,518 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:05,525 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 01:49:05,527 INFO sqlalchemy.engine.Engine [generated in 0.00229s] {'exc_id': '8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'}
2026-02-28 01:49:05,529 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 01:49:05,531 INFO sqlalchemy.engine.Engine [cached since 0.005817s ago] {'exc_id': '8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'}
2026-02-28 01:49:05,532 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:49:05,534 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:05,535 INFO sqlalchemy.engine.Engine 
                    SELECT DISTINCT i.domain
                    FROM investigations i
                    JOIN evidence e ON e.investigation_id = i.id
                    WHERE i.id != %(exc_id)s
                      AND i.state = 'concluded'
                      AND (e.evidence_json->'whois'->>'registrar' = %(registrar)s)
                    LIMIT 20
                
2026-02-28 01:49:05,536 INFO sqlalchemy.engine.Engine [generated in 0.00118s] {'exc_id': '8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff', 'registrar': 'RESERVED-Internet Assigned Numbers Authority'}
2026-02-28 01:49:05,546 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:49:52,216 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:52,216 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:49:52,217 INFO sqlalchemy.engine.Engine [cached since 63.76s ago] {'pk_1': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:49:52,221 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:49:52,222 INFO sqlalchemy.engine.Engine [generated in 0.00174s] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 27, 23, 49, 52, 220532, tzinfo=datetime.timezone.utc), 'classification': 'inconclusive', 'confidence': 'low', 'risk_score': 30, 'recommended_action': 'investigate', 'investigations_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:49:52,228 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 01:49:52,228 INFO sqlalchemy.engine.Engine [generated in 0.00191s] {'id': UUID('73713c6d-3661-4d10-880c-1db5769ca577'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'evidence_json': '{"domain": "example.com", "observable_type": "domain", "investigation_id": "8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff", "target_domain": "example.com", "t ... (53334 characters truncated) ... 55, "browser_postprocessing": 10906, "infrastructure_correlation": 1266, "signals_and_gaps": 0, "report_generation": 46656, "analysis_total": 59703}}', 'signals': '[{"id": "sig_no_hsts", "category": "security_posture", "description": "No HSTS header present", "severity": "low", "evidence_refs": ["http.security_h ... (1519 characters truncated) ... n": "PhishTank: URL found in phishing database (pending verification)", "severity": "high", "evidence_refs": ["threat_feeds.phishtank.in_database"]}]', 'data_gaps': '[]', 'external_context': 'null'}
2026-02-28 01:49:52,238 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 01:49:52,240 INFO sqlalchemy.engine.Engine [generated in 0.00085s] {'id': UUID('c37cc709-5865-4ca6-bcf3-2f40b934c845'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'iteration': 0, 'report_json': '{"classification": "inconclusive", "confidence": "low", "investigation_state": "concluded", "primary_reasoning": "Analyst timeout after 45s. Fallback ... (1270 characters truncated) ... us, 0 suspicious of 93; PhishTank match (unverified)", "recommendations_narrative": "Recommended action: investigate. No additional steps required."}', 'executive_summary': 'Automated analysis for DOMAIN  -  example.com. Classification: INCONCLUSIVE (low confidence). Risk score: 30/100. Key evidence: VirusTotal: 0 malicious, 0 suspicious of 93; PhishTank match (unverified)', 'technical_narrative': 'Automated analysis for DOMAIN  -  example.com. Classification: INCONCLUSIVE (low confidence). Risk score: 30/100. Key evidence: VirusTotal: 0 malicious, 0 suspicious of 93; PhishTank match (unverified)', 'recommendations': 'Recommended action: investigate. No additional steps required.'}
2026-02-28 01:49:52,243 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,244 INFO sqlalchemy.engine.Engine [generated in 0.00082s] {'id': UUID('c944f22c-f4c4-4999-ae4c-f67f88790f19'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'tls', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 265, 'evidence_json': '{"meta": {"collector": "tls", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.505324Z", "completed_at": "2026-02-27T23: ... (558 characters truncated) ... , "is_self_signed": false, "chain_length": 1, "chain_issuers": [], "cert_sha256": "7a70788fe1f5a90e81f7acbdc16422cb6e5d764be8d0f4da9721ba9674aa8ba9"}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,248 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,249 INFO sqlalchemy.engine.Engine [cached since 0.00572s ago] {'id': UUID('d71e563d-8286-4cbd-9792-6fe5c6a18bde'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'asn', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 204, 'evidence_json': '{"meta": {"collector": "asn", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.598571Z", "completed_at": "2026-02-27T23: ... (243 characters truncated) ... c.", "country": "Canada", "city": "Toronto", "is_cdn": true, "is_cloud": false, "is_hosting": true, "reverse_dns": "", "related_domains_same_ip": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,251 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,253 INFO sqlalchemy.engine.Engine [cached since 0.008914s ago] {'id': UUID('7417e2da-ba82-4811-8143-e8a01a0a4405'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'dns', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 500, 'evidence_json': '{"meta": {"collector": "dns", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.499908Z", "completed_at": "2026-02-27T23: ... (1210 characters truncated) ... ["v=spf1 -all", "_k2n1y4vw3qtb4skdx9e7dxt97qrmmq9"], "dmarc": "v=DMARC1;p=reject;sp=reject;adkim=s;aspf=s", "spf": "v=spf1 -all", "has_dnssec": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,257 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,258 INFO sqlalchemy.engine.Engine [cached since 0.01467s ago] {'id': UUID('e76450e7-8cce-45d1-8185-631a59296b0a'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'whois', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1467, 'evidence_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.506525Z", "completed_at": "2026-02-27T2 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,261 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,262 INFO sqlalchemy.engine.Engine [cached since 0.01807s ago] {'id': UUID('b83cad1d-af97-4b2c-a17f-ead424e18054'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'http', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 2217, 'evidence_json': '{"meta": {"collector": "http", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.503574Z", "completed_at": "2026-02-27T23 ... (793 characters truncated) ...  false, "technologies_detected": ["Cloudflare"], "security_headers": {}, "brand_indicators": [], "phishing_indicators": [], "external_resources": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,264 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,265 INFO sqlalchemy.engine.Engine [cached since 0.02106s ago] {'id': UUID('8da20077-b3b0-4a9b-827d-4e16ff06fa7f'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 2657, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.642530Z", "completed_at": "2026-02-27T23:4 ... (10398 characters truncated) ... ubject": "example.com", "vt_registrar": "RESERVED-Internet Assigned Numbers Authority", "tags": [], "notes": [], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,270 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,272 INFO sqlalchemy.engine.Engine [cached since 0.02734s ago] {'id': UUID('92f22344-e048-4615-9553-ed2806e2b9cc'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'threat_feeds', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3438, 'evidence_json': '{"meta": {"collector": "threat_feeds", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.643817Z", "completed_at": "2026- ... (579 characters truncated) ... matches": [], "openphish_listed": false, "feeds_checked": ["abuseipdb", "phishtank", "openphish"], "feeds_skipped": ["threatfox (error: HTTPError)"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,278 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:49:52,280 INFO sqlalchemy.engine.Engine [cached since 0.03626s ago] {'id': UUID('2366c5e2-070c-4354-a925-2cf1c6080009'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'collector_name': 'intel', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3844, 'evidence_json': '{"meta": {"collector": "intel", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.611132Z", "completed_at": "2026-02-27T2 ... (12399 characters truncated) ... , "not_before": "2023-01-27T01:21:18", "not_after": "2033-01-24T01:21:18", "entry_timestamp": null, "name_value": "example.com\\nuser@example.com"}]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:49:52,286 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 01:49:52,286 INFO sqlalchemy.engine.Engine [generated in 0.00104s] {'id': UUID('fba1d31c-9d64-438a-a6bc-dd6a0a0510bb'), 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'type': 'ip', 'value': '104.18.27.120', 'context': 'AbuseIPDB lookup target', 'confidence': 'medium'}
2026-02-28 01:49:52,291 INFO sqlalchemy.engine.Engine SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = %(domain_1)s ORDER BY whois_history.captured_at DESC 
 LIMIT %(param_1)s
2026-02-28 01:49:52,292 INFO sqlalchemy.engine.Engine [generated in 0.00104s] {'domain_1': 'example.com', 'param_1': 1}
2026-02-28 01:49:52,296 INFO sqlalchemy.engine.Engine INSERT INTO whois_history (id, domain, whois_json, investigation_id, changes_from_previous) VALUES (%(id)s::UUID, %(domain)s, %(whois_json)s::JSONB, %(investigation_id)s::UUID, %(changes_from_previous)s::JSONB) RETURNING whois_history.captured_at
2026-02-28 01:49:52,297 INFO sqlalchemy.engine.Engine [generated in 0.00102s] {'id': UUID('21f25f48-1df6-4906-a6ba-a8b95929d28c'), 'domain': 'example.com', 'whois_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:48:48.506525Z", "completed_at": "2026-02-27T2 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'investigation_id': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff'), 'changes_from_previous': '{}'}
2026-02-28 01:49:52,298 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:49:52,305 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:49:52,309 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:49:52,311 INFO sqlalchemy.engine.Engine [generated in 0.00159s] {'pk_1': UUID('8fdcc5ad-31a4-4a1b-9d22-82e8521cd1ff')}
2026-02-28 01:49:52,314 INFO sqlalchemy.engine.Engine SELECT clients.id, clients.name, clients.domain, clients.aliases, clients.brand_keywords, clients.contact_email, clients.notes, clients.status, clients.created_at, clients.alert_count, clients.last_alert_at, clients.default_collectors 
FROM clients 
WHERE clients.status = %(status_1)s
2026-02-28 01:49:52,315 INFO sqlalchemy.engine.Engine [generated in 0.00105s] {'status_1': 'active'}
2026-02-28 01:49:52,320 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:53:53,317 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:53:53,318 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:53:53,319 INFO sqlalchemy.engine.Engine [cached since 304.9s ago] {'pk_1': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:53:53,322 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:53:53,324 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:53:53,324 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:53:53,325 INFO sqlalchemy.engine.Engine [cached since 304.9s ago] {'pk_1': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:53:53,328 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:53:53,328 INFO sqlalchemy.engine.Engine [cached since 304.8s ago] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 27, 23, 53, 53, 327976, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:53:53,330 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:54:14,112 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:54:14,113 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:54:14,114 INFO sqlalchemy.engine.Engine [cached since 325.7s ago] {'pk_1': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:54:14,116 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:54:14,116 INFO sqlalchemy.engine.Engine [cached since 325.6s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 27, 23, 54, 14, 116055, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:54:14,118 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:54:23,296 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:54:23,298 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 01:54:23,299 INFO sqlalchemy.engine.Engine [cached since 321.3s ago] {'id': UUID('58a90992-3e34-49c5-8f91-04430728264a'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'screenshot', 'artifact_name': 'screenshot_domain.png', 'sha256_hash': '17925575629b07d74ee92f82211c18950af33eae49d5368250569503a8c3fb23', 'content_type': 'image/png', 'size_bytes': 357858, 'storage_path': 'artifacts\\23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d\\screenshot_domain.png'}
2026-02-28 01:54:23,301 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:54:25,159 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:54:25,161 INFO sqlalchemy.engine.Engine INSERT INTO artifacts (id, investigation_id, collector_name, artifact_name, sha256_hash, content_type, size_bytes, storage_path) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(artifact_name)s, %(sha256_hash)s, %(content_type)s, %(size_bytes)s, %(storage_path)s) RETURNING artifacts.created_at
2026-02-28 01:54:25,162 INFO sqlalchemy.engine.Engine [cached since 323.1s ago] {'id': UUID('4a4a31e6-ef1e-4014-8f2b-8378b57f1a99'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'js_analysis', 'artifact_name': 'network_capture.har', 'sha256_hash': '1577f5596377a43af6b22ec5321f372e66788572ae0f2edfd0fa7a8833be6a51', 'content_type': 'application/json', 'size_bytes': 8205, 'storage_path': 'artifacts\\23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d\\network_capture.har'}
2026-02-28 01:54:25,163 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:54:26,193 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:54:26,198 INFO sqlalchemy.engine.Engine 
                    SELECT DISTINCT i.domain
                    FROM investigations i
                    JOIN evidence e ON e.investigation_id = i.id
                    WHERE i.id != %(exc_id)s
                      AND i.state = 'concluded'
                      AND (e.evidence_json->'whois'->>'registrar' = %(registrar)s)
                    LIMIT 20
                
2026-02-28 01:54:26,200 INFO sqlalchemy.engine.Engine [cached since 320.7s ago] {'exc_id': '23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d', 'registrar': 'ICI - Registrar'}
2026-02-28 01:54:26,213 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:55:12,375 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:55:12,377 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:55:12,379 INFO sqlalchemy.engine.Engine [cached since 383.9s ago] {'pk_1': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:55:12,383 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:55:12,384 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 27, 23, 55, 12, 383243, tzinfo=datetime.timezone.utc), 'classification': 'benign', 'confidence': 'medium', 'risk_score': 15, 'recommended_action': 'monitor', 'investigations_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:55:12,390 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 01:55:12,391 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('9e241466-ce57-42ae-834f-c7f9021e47ec'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'evidence_json': '{"domain": "https://time.expertware.ro/Timesheet/Index", "observable_type": "url", "investigation_id": "23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d", "targe ... (90808 characters truncated) ... 13, "browser_postprocessing": 10000, "infrastructure_correlation": 2202, "signals_and_gaps": 0, "report_generation": 45000, "analysis_total": 58218}}', 'signals': '[{"id": "sig_login_form", "category": "content", "description": "Page contains a login/password form", "severity": "info", "evidence_refs": ["http.ha ... (1902 characters truncated) ... ertificate issuers across 69 certs \\u2014 infrastructure changes over time", "severity": "info", "evidence_refs": ["cert_timeline.unique_issuers"]}]', 'data_gaps': '[]', 'external_context': 'null'}
2026-02-28 01:55:12,400 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 01:55:12,401 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('d8257abe-46de-4e76-b999-98edbc0f9e87'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'iteration': 0, 'report_json': '{"classification": "benign", "confidence": "medium", "investigation_state": "concluded", "primary_reasoning": "Analyst timeout after 45s. Fallback au ... (1106 characters truncated) ... ey evidence: VirusTotal: 0 malicious, 0 suspicious of 94", "recommendations_narrative": "Recommended action: monitor. No additional steps required."}', 'executive_summary': 'Automated analysis for URL  -  https://time.expertware.ro/Timesheet/Index. Classification: BENIGN (medium confidence). Risk score: 15/100. Key evidence: VirusTotal: 0 malicious, 0 suspicious of 94', 'technical_narrative': 'Automated analysis for URL  -  https://time.expertware.ro/Timesheet/Index. Classification: BENIGN (medium confidence). Risk score: 15/100. Key evidence: VirusTotal: 0 malicious, 0 suspicious of 94', 'recommendations': 'Recommended action: monitor. No additional steps required.'}
2026-02-28 01:55:12,405 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,407 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('39be2f62-317b-4d59-98fc-8d22a94a99de'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'tls', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 141, 'evidence_json': '{"meta": {"collector": "tls", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.345844Z", "completed_at": "2026-02-27T23: ... (548 characters truncated) ... , "is_self_signed": false, "chain_length": 1, "chain_issuers": [], "cert_sha256": "acb90ee37f845b116a2d21578ef51e26e7fea99f56fa22d9f85ea9ad33935291"}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,412 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,413 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('ea6f255f-9bf6-4dc4-a794-5a05275e69f1'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'asn', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 170, 'evidence_json': '{"meta": {"collector": "asn", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.425572Z", "completed_at": "2026-02-27T23: ... (243 characters truncated) ... c.", "country": "Canada", "city": "Toronto", "is_cdn": true, "is_cloud": false, "is_hosting": true, "reverse_dns": "", "related_domains_same_ip": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,416 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,418 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('e3c30553-a3f7-403d-a1e6-bc35ff7b4361'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'dns', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 343, 'evidence_json': '{"meta": {"collector": "dns", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.342810Z", "completed_at": "2026-02-27T23: ... (567 characters truncated) ... 2606:4700:3033::ac43:b74b", "2606:4700:3037::6815:12c2"], "cname": [], "mx": [], "ns": [], "txt": [], "dmarc": null, "spf": null, "has_dnssec": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,421 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,423 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('77055deb-c7b7-40ed-a8ef-7156e5515099'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'whois', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 593, 'evidence_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.420502Z", "completed_at": "2026-02-27T2 ... (306 characters truncated) ... lse, "registrant_org": null, "registrant_country": null, "name_servers": ["delilah.ns.cloudflare.com", "hugh.ns.cloudflare.com"], "statuses": ["OK"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,429 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,431 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('1d587e17-23c3-4e3a-88a6-38e4ce98c82d'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1577, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.430136Z", "completed_at": "2026-02-27T23:5 ... (9492 characters truncated) ... ": "", "vt_cert_subject": "", "vt_registrar": "", "tags": ["external-resources", "password-input"], "notes": [], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,438 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,440 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('e7951868-5c81-427a-82c5-5649dea5f551'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'http', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1702, 'evidence_json': '{"meta": {"collector": "http", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.344078Z", "completed_at": "2026-02-27T23 ... (2535 characters truncated) ... on"], "external_resources": ["cdn.jsdelivr.net", "cdnjs.cloudflare.com", "stackpath.bootstrapcdn.com", "static.cloudflareinsights.com", "unpkg.com"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,445 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,447 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('d842291d-2b9f-4609-bac5-cc7ccc9d02fc'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'threat_feeds', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 2061, 'evidence_json': '{"meta": {"collector": "threat_feeds", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.432112Z", "completed_at": "2026- ... (500 characters truncated) ... matches": [], "openphish_listed": false, "feeds_checked": ["abuseipdb", "phishtank", "openphish"], "feeds_skipped": ["threatfox (error: HTTPError)"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,451 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,454 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('20a1b440-78d0-433e-ad1f-755dc527be38'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'intel', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3765, 'evidence_json': '{"meta": {"collector": "intel", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.429143Z", "completed_at": "2026-02-27T2 ... (23589 characters truncated) ... fore": "2019-02-06T07:49:48", "not_after": "2019-05-07T07:49:48", "entry_timestamp": "2019-02-06T08:49:49.851", "name_value": "time.expertware.ro"}]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,460 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:55:12,461 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('a405b358-e5e8-4b5f-b8a1-9cee1c04afc9'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'collector_name': 'urlscan', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 20656, 'evidence_json': '{"meta": {"collector": "urlscan", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.433116Z", "completed_at": "2026-02-27 ... (1046 characters truncated) ... ries": [], "brands": [], "votesTotal": 0, "votesMalicious": 0, "votesBenign": 0, "malicious": false, "hasVerdicts": false}}, "tags": [], "notes": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:55:12,465 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 01:55:12,466 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('b03f4375-596e-4203-aebf-27c06614bcee'), 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'type': 'ip', 'value': '172.67.183.75', 'context': 'AbuseIPDB lookup target', 'confidence': 'medium'}
2026-02-28 01:55:12,468 INFO sqlalchemy.engine.Engine SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = %(domain_1)s ORDER BY whois_history.captured_at DESC 
 LIMIT %(param_1)s
2026-02-28 01:55:12,469 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'domain_1': 'time.expertware.ro', 'param_1': 1}
2026-02-28 01:55:12,472 INFO sqlalchemy.engine.Engine INSERT INTO whois_history (id, domain, whois_json, investigation_id, changes_from_previous) VALUES (%(id)s::UUID, %(domain)s, %(whois_json)s::JSONB, %(investigation_id)s::UUID, %(changes_from_previous)s::JSONB) RETURNING whois_history.captured_at
2026-02-28 01:55:12,473 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'id': UUID('bd80e8df-29ff-4c1d-976b-016ad14ae683'), 'domain': 'time.expertware.ro', 'whois_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:53:53.420502Z", "completed_at": "2026-02-27T2 ... (306 characters truncated) ... lse, "registrant_org": null, "registrant_country": null, "name_servers": ["delilah.ns.cloudflare.com", "hugh.ns.cloudflare.com"], "statuses": ["OK"]}', 'investigation_id': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d'), 'changes_from_previous': 'null'}
2026-02-28 01:55:12,475 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:55:12,479 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:55:12,479 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:55:12,481 INFO sqlalchemy.engine.Engine [cached since 320.2s ago] {'pk_1': UUID('23bdb9dc-bbe2-4c1b-939d-3a646cab4d4d')}
2026-02-28 01:55:12,483 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:57:31,840 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:57:31,841 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:57:31,842 INFO sqlalchemy.engine.Engine [cached since 523.4s ago] {'pk_1': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:31,846 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:57:31,848 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:57:31,850 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:57:31,852 INFO sqlalchemy.engine.Engine [cached since 523.4s ago] {'pk_1': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:31,854 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:57:31,855 INFO sqlalchemy.engine.Engine [cached since 523.4s ago] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 27, 23, 57, 31, 854144, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:31,857 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:57:32,934 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:57:32,936 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:57:32,936 INFO sqlalchemy.engine.Engine [cached since 524.5s ago] {'pk_1': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:32,939 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:57:32,940 INFO sqlalchemy.engine.Engine [cached since 524.5s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 27, 23, 57, 32, 938504, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:32,941 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:57:33,043 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:57:33,044 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:57:33,044 INFO sqlalchemy.engine.Engine [cached since 524.6s ago] {'pk_1': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:33,047 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:57:33,048 INFO sqlalchemy.engine.Engine [generated in 0.00083s] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 27, 23, 57, 33, 46312, tzinfo=datetime.timezone.utc), 'classification': 'inconclusive', 'confidence': 'low', 'recommended_action': 'investigate', 'investigations_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:33,050 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 01:57:33,051 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'id': UUID('03ad60f1-d793-45ce-860c-13253c788e4b'), 'investigation_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5'), 'evidence_json': '{"domain": "69aa0148cdc4fa6d8f48d1d037b991b394107d31da37a8516a644c1f919c24f2", "observable_type": "hash", "investigation_id": "ae40a2a2-ddd2-440c-b2b ... (1380 characters truncated) ... info", "evidence_refs": ["dns.mx"]}], "data_gaps": [], "pipeline_timings_ms": {"signals_and_gaps": 0, "report_generation": 31, "analysis_total": 63}}', 'signals': '[{"id": "sig_no_dmarc", "category": "email_security", "description": "No DMARC record \\u2014 domain can be spoofed in email", "severity": "low", "ev ... (50 characters truncated) ... "category": "email_security", "description": "No MX records \\u2014 domain does not receive email", "severity": "info", "evidence_refs": ["dns.mx"]}]', 'data_gaps': '[]', 'external_context': 'null'}
2026-02-28 01:57:33,053 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 01:57:33,054 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'id': UUID('77f120e9-74b7-4f1f-a76e-77d3841f9aaf'), 'investigation_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5'), 'iteration': 0, 'report_json': '{"classification": "inconclusive", "confidence": "low", "investigation_state": "concluded", "primary_reasoning": "Automated analysis for HASH  -  69a ... (1208 characters truncated) ...  Key evidence: Hash not found in VirusTotal database", "recommendations_narrative": "Recommended action: investigate. No additional steps required."}', 'executive_summary': 'Automated analysis for HASH  -  69aa0148cdc4fa6d8f48d1d037b991b394107d31da37a8516a644c1f919c24f2. Classification: INCONCLUSIVE (low confidence). Risk score undetermined. Key evidence: Hash not found in VirusTotal database', 'technical_narrative': 'Automated analysis for HASH  -  69aa0148cdc4fa6d8f48d1d037b991b394107d31da37a8516a644c1f919c24f2. Classification: INCONCLUSIVE (low confidence). Risk score undetermined. Key evidence: Hash not found in VirusTotal database', 'recommendations': 'Recommended action: investigate. No additional steps required.'}
2026-02-28 01:57:33,058 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:57:33,058 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'id': UUID('163e8259-10dd-4b25-afbf-fdca22e2169b'), 'investigation_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1047, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:57:31.867439Z", "completed_at": "2026-02-27T23:5 ... (466 characters truncated) ... : "", "vt_cert_subject": "", "vt_registrar": "", "tags": [], "notes": ["Hash not found in VirusTotal database"], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:57:33,062 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 01:57:33,063 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'id': UUID('26a52f16-4aa5-4bd6-a306-c9f47771af41'), 'investigation_id': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5'), 'type': 'hash', 'value': '69aa0148cdc4fa6d8f48d1d037b991b394107d31da37a8516a644c1f919c24f2', 'context': 'Investigated sample/hash', 'confidence': 'high'}
2026-02-28 01:57:33,066 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:57:33,068 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:57:33,070 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:57:33,070 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'pk_1': UUID('ae40a2a2-ddd2-440c-b2b7-cc9071fa0ef5')}
2026-02-28 01:57:33,073 INFO sqlalchemy.engine.Engine SELECT clients.id, clients.name, clients.domain, clients.aliases, clients.brand_keywords, clients.contact_email, clients.notes, clients.status, clients.created_at, clients.alert_count, clients.last_alert_at, clients.default_collectors 
FROM clients 
WHERE clients.status = %(status_1)s
2026-02-28 01:57:33,074 INFO sqlalchemy.engine.Engine [cached since 460.8s ago] {'status_1': 'active'}
2026-02-28 01:57:33,075 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:58:28,683 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:58:28,687 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:58:28,688 INFO sqlalchemy.engine.Engine [cached since 580.2s ago] {'pk_1': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:28,691 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 01:58:28,695 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:58:28,697 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:58:28,699 INFO sqlalchemy.engine.Engine [cached since 580.2s ago] {'pk_1': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:28,703 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:58:28,704 INFO sqlalchemy.engine.Engine [cached since 580.2s ago] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 27, 23, 58, 28, 702192, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:28,706 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:58:29,792 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:58:29,792 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:58:29,794 INFO sqlalchemy.engine.Engine [cached since 581.3s ago] {'pk_1': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:29,795 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:58:29,796 INFO sqlalchemy.engine.Engine [cached since 581.3s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 27, 23, 58, 29, 795871, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:29,799 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:58:29,833 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:58:29,834 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:58:29,835 INFO sqlalchemy.engine.Engine [cached since 581.4s ago] {'pk_1': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:29,837 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 01:58:29,837 INFO sqlalchemy.engine.Engine [cached since 517.6s ago] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 27, 23, 58, 29, 836314, tzinfo=datetime.timezone.utc), 'classification': 'benign', 'confidence': 'medium', 'risk_score': 5, 'recommended_action': 'allow', 'investigations_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:29,839 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 01:58:29,840 INFO sqlalchemy.engine.Engine [cached since 517.6s ago] {'id': UUID('a6cc993f-ca8e-4109-92b8-df10e6a6951f'), 'investigation_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529'), 'evidence_json': '{"domain": "6804e3d668f5e06fe5afc5f3e5539bf2bae7dc00552264f5849b90c4c531dfca", "observable_type": "hash", "investigation_id": "5a4e2819-9a89-4df8-a70 ... (10344 characters truncated) ... nce_refs": ["vt.reputation_score"]}], "data_gaps": [], "pipeline_timings_ms": {"signals_and_gaps": 0, "report_generation": 16, "analysis_total": 31}}', 'signals': '[{"id": "sig_no_dmarc", "category": "email_security", "description": "No DMARC record \\u2014 domain can be spoofed in email", "severity": "low", "ev ... (233 characters truncated) ... category": "reputation", "description": "VirusTotal community reputation score: -9", "severity": "medium", "evidence_refs": ["vt.reputation_score"]}]', 'data_gaps': '[]', 'external_context': 'null'}
2026-02-28 01:58:29,842 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 01:58:29,843 INFO sqlalchemy.engine.Engine [cached since 517.6s ago] {'id': UUID('c8bed036-8ef5-4d30-9638-783c0a36ca23'), 'investigation_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529'), 'iteration': 0, 'report_json': '{"classification": "benign", "confidence": "medium", "investigation_state": "concluded", "primary_reasoning": "Automated analysis for HASH  -  6804e3 ... (1136 characters truncated) ... 100. Key evidence: Clean  -  0/76 detections in VirusTotal", "recommendations_narrative": "Recommended action: allow. No additional steps required."}', 'executive_summary': 'Automated analysis for HASH  -  6804e3d668f5e06fe5afc5f3e5539bf2bae7dc00552264f5849b90c4c531dfca. Classification: BENIGN (medium confidence). Risk score: 5/100. Key evidence: Clean  -  0/76 detections in VirusTotal', 'technical_narrative': 'Automated analysis for HASH  -  6804e3d668f5e06fe5afc5f3e5539bf2bae7dc00552264f5849b90c4c531dfca. Classification: BENIGN (medium confidence). Risk score: 5/100. Key evidence: Clean  -  0/76 detections in VirusTotal', 'recommendations': 'Recommended action: allow. No additional steps required.'}
2026-02-28 01:58:29,845 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 01:58:29,847 INFO sqlalchemy.engine.Engine [cached since 517.6s ago] {'id': UUID('61395e2c-462e-4c8f-a540-8c52cc3ee93c'), 'investigation_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1061, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-27T23:58:28.718520Z", "completed_at": "2026-02-27T23:5 ... (9168 characters truncated) ... _installer.exe", "CapCut_7611644006593757192_installer.exe", "CapCut_7611640448809222161_installer.exe", "CapCut_7611641651253264401_installer.exe"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 01:58:29,849 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 01:58:29,850 INFO sqlalchemy.engine.Engine [cached since 517.6s ago] {'id': UUID('b5c76a50-be0f-494b-9eea-f64b5e9596a6'), 'investigation_id': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529'), 'type': 'hash', 'value': '6804e3d668f5e06fe5afc5f3e5539bf2bae7dc00552264f5849b90c4c531dfca', 'context': 'Investigated sample/hash', 'confidence': 'high'}
2026-02-28 01:58:29,851 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 01:58:29,853 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 01:58:29,854 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 01:58:29,855 INFO sqlalchemy.engine.Engine [cached since 517.5s ago] {'pk_1': UUID('5a4e2819-9a89-4df8-a706-66b1fc9d7529')}
2026-02-28 01:58:29,856 INFO sqlalchemy.engine.Engine ROLLBACK
