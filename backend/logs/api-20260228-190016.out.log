[config] Loaded .env from: C:\Users\tmoscaliuc\Downloads\script\threat-investigator\threat-intel\backend\.env
[config] Settings loaded — VT key: SET
2026-02-28 19:00:37,440 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-02-28 19:00:37,447 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 19:00:37,455 INFO sqlalchemy.engine.Engine select current_schema()
2026-02-28 19:00:37,458 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 19:00:37,470 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-02-28 19:00:37,473 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 19:00:37,477 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 19:00:37,493 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,495 INFO sqlalchemy.engine.Engine [generated in 0.00238s] ('batches', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,506 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,507 INFO sqlalchemy.engine.Engine [cached since 0.01458s ago] ('investigations', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,509 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,510 INFO sqlalchemy.engine.Engine [cached since 0.01754s ago] ('collector_results', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,514 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,516 INFO sqlalchemy.engine.Engine [cached since 0.02405s ago] ('evidence', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,521 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,523 INFO sqlalchemy.engine.Engine [cached since 0.03005s ago] ('reports', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,525 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,526 INFO sqlalchemy.engine.Engine [cached since 0.0336s ago] ('artifacts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,531 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,534 INFO sqlalchemy.engine.Engine [cached since 0.04132s ago] ('iocs', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,536 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,538 INFO sqlalchemy.engine.Engine [cached since 0.04577s ago] ('watchlist', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,540 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,541 INFO sqlalchemy.engine.Engine [cached since 0.04866s ago] ('watchlist_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,542 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,543 INFO sqlalchemy.engine.Engine [cached since 0.0512s ago] ('clients', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,544 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,546 INFO sqlalchemy.engine.Engine [cached since 0.05371s ago] ('client_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,548 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,549 INFO sqlalchemy.engine.Engine [cached since 0.05616s ago] ('whois_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,551 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,552 INFO sqlalchemy.engine.Engine [cached since 0.05975s ago] ('ip_lookups', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,554 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 19:00:37,556 INFO sqlalchemy.engine.Engine [cached since 0.06327s ago] ('lookup_cache', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 19:00:37,559 INFO sqlalchemy.engine.Engine ALTER TABLE clients ADD COLUMN IF NOT EXISTS default_collectors JSONB NOT NULL DEFAULT '[]'::jsonb
2026-02-28 19:00:37,560 INFO sqlalchemy.engine.Engine [generated in 0.00126s] ()
2026-02-28 19:00:37,563 INFO sqlalchemy.engine.Engine ALTER TABLE investigations ADD COLUMN IF NOT EXISTS observable_type VARCHAR(20) NOT NULL DEFAULT 'domain'
2026-02-28 19:00:37,565 INFO sqlalchemy.engine.Engine [generated in 0.00163s] ()
2026-02-28 19:00:37,571 INFO sqlalchemy.engine.Engine ALTER TABLE investigations ALTER COLUMN domain TYPE VARCHAR(512)
2026-02-28 19:00:37,572 INFO sqlalchemy.engine.Engine [generated in 0.00138s] ()
2026-02-28 19:00:37,579 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 19:00:38,084 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 19:00:38,156 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 19:00:38,160 INFO sqlalchemy.engine.Engine [generated in 0.00395s] (1, 0)
2026-02-28 19:00:38,180 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 19:00:38,183 INFO sqlalchemy.engine.Engine [generated in 0.00392s] ()
INFO:     127.0.0.1:64997 - "GET /api/investigations?limit=1&offset=0 HTTP/1.1" 200 OK
2026-02-28 19:00:38,210 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 19:00:38,440 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 19:00:38,445 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 19:00:38,449 INFO sqlalchemy.engine.Engine [cached since 0.2932s ago] (10, 0)
2026-02-28 19:00:38,461 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 19:00:38,462 INFO sqlalchemy.engine.Engine [cached since 0.2825s ago] ()
INFO:     127.0.0.1:56870 - "GET /api/investigations?limit=10 HTTP/1.1" 200 OK
2026-02-28 19:00:38,472 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 19:00:38,489 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 19:00:38,492 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 19:00:38,495 INFO sqlalchemy.engine.Engine [cached since 0.3382s ago] (10, 0)
2026-02-28 19:00:38,500 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 19:00:38,503 INFO sqlalchemy.engine.Engine [cached since 0.3237s ago] ()
INFO:     127.0.0.1:56872 - "GET /api/investigations?limit=10 HTTP/1.1" 200 OK
2026-02-28 19:00:38,509 INFO sqlalchemy.engine.Engine COMMIT
INFO:     127.0.0.1:52095 - "POST /api/email-investigations/upload HTTP/1.1" 200 OK
INFO:     127.0.0.1:51223 - "POST /api/email-investigations/upload HTTP/1.1" 200 OK
