[config] Loaded .env from: C:\Users\tmoscaliuc\Downloads\script\threat-investigator\threat-intel\backend\.env
[config] Settings loaded — VT key: SET
 
 -------------- celery-local-8010-20260228-183300@EXP-JFW2P34 v5.6.2 (recovery)
--- ***** ----- 
-- ******* ---- Windows-11-10.0.26200-SP0 2026-02-28 18:33:08
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         threat_intel:0x20e288c74d0
- ** ---------- .> transport:   redis://127.0.0.1:6379/5
- ** ---------- .> results:     redis://127.0.0.1:6379/6
- *** --- * --- .> concurrency: 8 (thread)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> investigations   exchange=investigations(direct) key=investigations
                

[tasks]
  . tasks.process_batch
  . tasks.run_analysis
  . tasks.run_collector
  . tasks.run_investigation
  . tasks.watchlist_check

2026-02-28 18:33:11,187 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-02-28 18:33:11,190 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 18:33:11,193 INFO sqlalchemy.engine.Engine select current_schema()
2026-02-28 18:33:11,196 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 18:33:11,201 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-02-28 18:33:11,204 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-02-28 18:33:11,209 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:11,210 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:11,342 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:11,343 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:11,348 INFO sqlalchemy.engine.Engine [generated in 0.00559s] {'pk_1': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:33:11,349 INFO sqlalchemy.engine.Engine [generated in 0.00560s] {'pk_1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:33:11,359 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:33:11,360 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:33:11,364 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:11,366 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:11,367 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:11,368 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:11,369 INFO sqlalchemy.engine.Engine [cached since 0.02645s ago] {'pk_1': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:33:11,371 INFO sqlalchemy.engine.Engine [cached since 0.02741s ago] {'pk_1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:33:11,378 INFO sqlalchemy.engine.Engine UPDATE investigations SET updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:33:11,381 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:33:11,381 INFO sqlalchemy.engine.Engine [generated in 0.00387s] {'updated_at': datetime.datetime(2026, 2, 28, 16, 33, 11, 373610, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:33:11,383 INFO sqlalchemy.engine.Engine [generated in 0.00153s] {'state': 'gathering', 'updated_at': datetime.datetime(2026, 2, 28, 16, 33, 11, 379617, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:33:11,387 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:33:11,387 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:33:16,380 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:16,382 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:16,384 INFO sqlalchemy.engine.Engine [cached since 5.041s ago] {'pk_1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:33:16,389 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:33:16,391 INFO sqlalchemy.engine.Engine [cached since 5.01s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 28, 16, 33, 16, 388373, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:33:16,393 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:33:17,580 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:17,584 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 18:33:17,585 INFO sqlalchemy.engine.Engine [generated in 0.00165s] {'exc_id': '3f4f81c0-a3bb-4272-b291-4b9cc9518a51'}
2026-02-28 18:33:17,589 INFO sqlalchemy.engine.Engine 
                        SELECT i.domain
                        FROM investigations i
                        JOIN evidence e ON e.investigation_id = i.id
                        WHERE i.id != %(exc_id)s
                          AND i.state = 'concluded'
                          AND e.evidence_json->'dns'->'ns' @> :ns_val::jsonb
                        LIMIT 20
                    
2026-02-28 18:33:17,591 INFO sqlalchemy.engine.Engine [cached since 0.007138s ago] {'exc_id': '3f4f81c0-a3bb-4272-b291-4b9cc9518a51'}
2026-02-28 18:33:17,593 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:33:17,596 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:17,598 INFO sqlalchemy.engine.Engine 
                    SELECT DISTINCT i.domain
                    FROM investigations i
                    JOIN evidence e ON e.investigation_id = i.id
                    WHERE i.id != %(exc_id)s
                      AND i.state = 'concluded'
                      AND (e.evidence_json->'whois'->>'registrar' = %(registrar)s)
                    LIMIT 20
                
2026-02-28 18:33:17,599 INFO sqlalchemy.engine.Engine [generated in 0.00138s] {'exc_id': '3f4f81c0-a3bb-4272-b291-4b9cc9518a51', 'registrar': 'RESERVED-Internet Assigned Numbers Authority'}
2026-02-28 18:33:17,622 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:33:33,367 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:33,368 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:33:33,369 INFO sqlalchemy.engine.Engine [cached since 22.03s ago] {'pk_1': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:33:33,372 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=%(updated_at)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:33:33,372 INFO sqlalchemy.engine.Engine [cached since 21.99s ago] {'state': 'evaluating', 'updated_at': datetime.datetime(2026, 2, 28, 16, 33, 33, 371571, tzinfo=datetime.timezone.utc), 'investigations_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:33:33,374 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:33:33,557 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:33:33,561 INFO sqlalchemy.engine.Engine 
                    SELECT DISTINCT i.domain
                    FROM investigations i
                    JOIN evidence e ON e.investigation_id = i.id
                    WHERE i.id != %(exc_id)s
                      AND i.state = 'concluded'
                      AND (e.evidence_json->'whois'->>'registrar' = %(registrar)s)
                    LIMIT 20
                
2026-02-28 18:33:33,564 INFO sqlalchemy.engine.Engine [cached since 15.97s ago] {'exc_id': 'c370d33f-5b74-4172-9d94-96fafb372289', 'registrar': 'RESERVED-Internet Assigned Numbers Authority'}
2026-02-28 18:33:33,612 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:34:50,984 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:34:50,985 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:34:50,986 INFO sqlalchemy.engine.Engine [cached since 99.64s ago] {'pk_1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:34:50,990 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:34:50,991 INFO sqlalchemy.engine.Engine [generated in 0.00103s] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 28, 16, 34, 50, 989869, tzinfo=datetime.timezone.utc), 'classification': 'suspicious', 'confidence': 'medium', 'risk_score': 30, 'recommended_action': 'investigate', 'investigations_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:34:50,999 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 18:34:51,000 INFO sqlalchemy.engine.Engine [generated in 0.00321s] {'id': UUID('38c2f66a-12bd-4342-a362-d43cac5bbaab'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'evidence_json': '{"domain": "https://example.com", "observable_type": "url", "investigation_id": "3f4f81c0-a3bb-4272-b291-4b9cc9518a51", "target_domain": "example.com ... (43727 characters truncated) ... timings_ms": {"email_security": 141, "infrastructure_correlation": 1000, "signals_and_gaps": 0, "report_generation": 93342, "analysis_total": 94561}}', 'signals': '[{"id": "sig_email_security_strong", "category": "email_security", "description": "Strong email security posture (score: 100/100)", "severity": "info ... (955 characters truncated) ... n": "PhishTank: URL found in phishing database (pending verification)", "severity": "high", "evidence_refs": ["threat_feeds.phishtank.in_database"]}]', 'data_gaps': '[{"id": "gap_http_failed", "description": "HTTP collection failed: SSLError: HTTPSConnectionPool(host=\'example.com\', port=443): Max retries exceede ... (407 characters truncated) ... verify failed: unable to get local issuer certificate (_ssl.c:1010)\')))", "impact": "Cannot assess web content, login forms, or redirect behavior"}]', 'external_context': 'null'}
2026-02-28 18:34:51,010 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 18:34:51,012 INFO sqlalchemy.engine.Engine [generated in 0.00182s] {'id': UUID('ff40a0c7-9d6a-4b75-844c-430d318f069b'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'iteration': 0, 'report_json': '{"classification": "suspicious", "confidence": "medium", "investigation_state": "concluded", "primary_reasoning": "The URL resolves to Cloudflare-hos ... (14841 characters truncated) ... classify as \\"suspicious\\" with medium confidence. Data gaps prevent a conclusive benign or malicious verdict.", "recommendations_narrative": null}', 'executive_summary': '- Investigated: https://example.com (observable_type = url). Primary focus: malware delivery, credential harvesting, phishing, and redirect behavior. ... (739 characters truncated) ... _score = 100).\n- Classification: suspicious (confidence: medium). Action: further investigation (retrieve page content and run dynamic JS analysis).', 'technical_narrative': 'Step 1 — Baseline plausibility\n- Legitimate operators frequently use Cloudflare (hosting.asn_org = Cloudflare, Inc.; hosting.is_cdn = true) and obta ... (4173 characters truncated) ... tial-harvesting or malware distribution, classify as "suspicious" with medium confidence. Data gaps prevent a conclusive benign or malicious verdict.', 'recommendations': None}
2026-02-28 18:34:51,020 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,022 INFO sqlalchemy.engine.Engine [generated in 0.00211s] {'id': UUID('13c40744-02c6-4187-8e0e-12a5940b5440'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'tls', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 546, 'evidence_json': '{"meta": {"collector": "tls", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.690906Z", "completed_at": "2026-02-28T16: ... (558 characters truncated) ... , "is_self_signed": false, "chain_length": 1, "chain_issuers": [], "cert_sha256": "7a70788fe1f5a90e81f7acbdc16422cb6e5d764be8d0f4da9721ba9674aa8ba9"}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,026 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,027 INFO sqlalchemy.engine.Engine [cached since 0.007382s ago] {'id': UUID('b2bcefa1-c3b6-4059-9f0f-59317f01238d'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'asn', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 250, 'evidence_json': '{"meta": {"collector": "asn", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:12.015404Z", "completed_at": "2026-02-28T16: ... (243 characters truncated) ... c.", "country": "Canada", "city": "Toronto", "is_cdn": true, "is_cloud": false, "is_hosting": true, "reverse_dns": "", "related_domains_same_ip": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,031 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,032 INFO sqlalchemy.engine.Engine [cached since 0.01242s ago] {'id': UUID('0aa509ff-ebec-4ec1-8900-318c70c82c41'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'dns', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 795, 'evidence_json': '{"meta": {"collector": "dns", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.678913Z", "completed_at": "2026-02-28T16: ... (1213 characters truncated) ... ["v=spf1 -all", "_k2n1y4vw3qtb4skdx9e7dxt97qrmmq9"], "dmarc": "v=DMARC1;p=reject;sp=reject;adkim=s;aspf=s", "spf": "v=spf1 -all", "has_dnssec": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,036 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,037 INFO sqlalchemy.engine.Engine [cached since 0.01824s ago] {'id': UUID('bee4af1d-c4cd-4ad0-9369-de6fc70edbb9'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'whois', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 1813, 'evidence_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.978285Z", "completed_at": "2026-02-28T1 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,042 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,043 INFO sqlalchemy.engine.Engine [cached since 0.0234s ago] {'id': UUID('927b9538-c016-4b60-81d3-aede3cf758ba'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'http', 'status': 'failed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3156, 'evidence_json': '{"meta": {"collector": "http", "version": "1.0.0", "status": "failed", "started_at": "2026-02-28T16:33:11.683385Z", "completed_at": "2026-02-28T16:33 ... (580 characters truncated) ... nput_fields": null, "technologies_detected": [], "security_headers": {}, "brand_indicators": [], "phishing_indicators": [], "external_resources": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,046 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,047 INFO sqlalchemy.engine.Engine [cached since 0.02712s ago] {'id': UUID('98544f67-b5d9-442f-b88e-f3d4e64b2a0e'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3108, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:12.055970Z", "completed_at": "2026-02-28T16:3 ... (9554 characters truncated) ...  "vt_dns_records": [], "vt_cert_issuer": "", "vt_cert_subject": "", "vt_registrar": "", "tags": [], "notes": [], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,053 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,055 INFO sqlalchemy.engine.Engine [cached since 0.03528s ago] {'id': UUID('1ba146eb-5b3c-4462-a55e-55231eea6bf6'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'threat_feeds', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3811, 'evidence_json': '{"meta": {"collector": "threat_feeds", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:12.062400Z", "completed_at": "2026- ... (579 characters truncated) ... matches": [], "openphish_listed": false, "feeds_checked": ["abuseipdb", "phishtank", "openphish"], "feeds_skipped": ["threatfox (error: HTTPError)"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,068 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:51,069 INFO sqlalchemy.engine.Engine [cached since 0.04886s ago] {'id': UUID('972b4cc8-a7a4-477d-843f-4939372450bd'), 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'collector_name': 'intel', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 4327, 'evidence_json': '{"meta": {"collector": "intel", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:12.039355Z", "completed_at": "2026-02-28T1 ... (12399 characters truncated) ... , "not_before": "2023-01-27T01:21:18", "not_after": "2033-01-24T01:21:18", "entry_timestamp": null, "name_value": "example.com\\nuser@example.com"}]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:51,072 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id__0)s::UUID, %(investigation_id__0)s::UUID, %(type__0)s, %(value__0)s, %(context__0)s, %(confidence__0)s), (%(id__1)s::UUID, %(investigation_id__1)s::UUID, %(type__ ... 324 characters truncated ... ID, %(type__4)s, %(value__4)s, %(context__4)s, %(confidence__4)s) RETURNING iocs.created_at, iocs.id
2026-02-28 18:34:51,074 INFO sqlalchemy.engine.Engine [generated in 0.00014s (insertmanyvalues) 1/1 (ordered)] {'investigation_id__0': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'confidence__0': 'high', 'context__0': 'Investigated observable (page content not retrieved due to TLS verification failure)', 'type__0': 'url', 'id__0': UUID('487cee8a-2fdb-48d7-b656-148c1af840cf'), 'value__0': 'https://example.com', 'investigation_id__1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'confidence__1': 'high', 'context__1': 'A record for example.com (Cloudflare CDN)', 'type__1': 'ip', 'id__1': UUID('2494f306-8b11-4705-a026-375ff9fcca9c'), 'value__1': '104.18.26.120', 'investigation_id__2': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'confidence__2': 'high', 'context__2': 'A record for example.com (Cloudflare CDN)', 'type__2': 'ip', 'id__2': UUID('9df9b5bd-e140-4ef6-b759-fadd2456b342'), 'value__2': '104.18.27.120', 'investigation_id__3': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'confidence__3': 'high', 'context__3': 'TLS certificate (tls.cert_sha256) observed for the host', 'type__3': 'hash', 'id__3': UUID('4bea5e9b-be23-429c-a15e-cafa416a8e0b'), 'value__3': '7a70788fe1f5a90e81f7acbdc16422cb6e5d764be8d0f4da9721ba9674aa8ba9', 'investigation_id__4': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'confidence__4': 'high', 'context__4': 'Investigated domain (whois, dns, email_security, cert timeline)', 'type__4': 'domain', 'id__4': UUID('bcffc8f6-9b2b-43e2-99a5-346d33d0af2a'), 'value__4': 'example.com'}
2026-02-28 18:34:51,079 INFO sqlalchemy.engine.Engine SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = %(domain_1)s ORDER BY whois_history.captured_at DESC 
 LIMIT %(param_1)s
2026-02-28 18:34:51,081 INFO sqlalchemy.engine.Engine [generated in 0.00149s] {'domain_1': 'example.com', 'param_1': 1}
2026-02-28 18:34:51,087 INFO sqlalchemy.engine.Engine INSERT INTO whois_history (id, domain, whois_json, investigation_id, changes_from_previous) VALUES (%(id)s::UUID, %(domain)s, %(whois_json)s::JSONB, %(investigation_id)s::UUID, %(changes_from_previous)s::JSONB) RETURNING whois_history.captured_at
2026-02-28 18:34:51,090 INFO sqlalchemy.engine.Engine [generated in 0.00243s] {'id': UUID('6da59131-5a4e-402a-84cb-4881572a796f'), 'domain': 'example.com', 'whois_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.978285Z", "completed_at": "2026-02-28T1 ... (584 characters truncated) ... ", "clientTransferProhibited https://icann.org/epp#clientTransferProhibited", "clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited"]}', 'investigation_id': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51'), 'changes_from_previous': '{}'}
2026-02-28 18:34:51,094 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:34:51,100 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:34:51,106 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:34:51,108 INFO sqlalchemy.engine.Engine [generated in 0.00202s] {'pk_1': UUID('3f4f81c0-a3bb-4272-b291-4b9cc9518a51')}
2026-02-28 18:34:51,114 INFO sqlalchemy.engine.Engine SELECT clients.id, clients.name, clients.domain, clients.aliases, clients.brand_keywords, clients.contact_email, clients.notes, clients.status, clients.created_at, clients.alert_count, clients.last_alert_at, clients.default_collectors 
FROM clients 
WHERE clients.status = %(status_1)s
2026-02-28 18:34:51,116 INFO sqlalchemy.engine.Engine [generated in 0.00185s] {'status_1': 'active'}
2026-02-28 18:34:51,122 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-28 18:34:55,534 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:34:55,536 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:34:55,537 INFO sqlalchemy.engine.Engine [cached since 104.2s ago] {'pk_1': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:34:55,540 INFO sqlalchemy.engine.Engine UPDATE investigations SET state=%(state)s, updated_at=now(), concluded_at=%(concluded_at)s, classification=%(classification)s, confidence=%(confidence)s, risk_score=%(risk_score)s, recommended_action=%(recommended_action)s WHERE investigations.id = %(investigations_id)s::UUID
2026-02-28 18:34:55,541 INFO sqlalchemy.engine.Engine [cached since 4.551s ago] {'state': 'concluded', 'concluded_at': datetime.datetime(2026, 2, 28, 16, 34, 55, 539746, tzinfo=datetime.timezone.utc), 'classification': 'inconclusive', 'confidence': 'low', 'risk_score': 40, 'recommended_action': 'investigate', 'investigations_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:34:55,545 INFO sqlalchemy.engine.Engine INSERT INTO evidence (id, investigation_id, evidence_json, signals, data_gaps, external_context) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(evidence_json)s::JSONB, %(signals)s::JSONB, %(data_gaps)s::JSONB, %(external_context)s::JSONB) RETURNING evidence.created_at
2026-02-28 18:34:55,547 INFO sqlalchemy.engine.Engine [cached since 4.549s ago] {'id': UUID('c47a19f9-e8a7-41fd-ac69-e2760565a1e2'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'evidence_json': '{"domain": "b.com", "observable_type": "domain", "investigation_id": "c370d33f-5b74-4172-9d94-96fafb372289", "target_domain": "b.com", "timestamps":  ... (109004 characters truncated) ... _timings_ms": {"email_security": 141, "infrastructure_correlation": 202, "signals_and_gaps": 0, "report_generation": 81797, "analysis_total": 82156}}', 'signals': '[{"id": "sig_no_dmarc", "category": "email_security", "description": "No DMARC record \\u2014 domain can be spoofed in email", "severity": "low", "ev ... (1729 characters truncated) ... putation", "description": "OpenPhish: Domain found in active phishing feed", "severity": "high", "evidence_refs": ["threat_feeds.openphish_listed"]}]', 'data_gaps': '[{"id": "gap_http_unreachable", "description": "Domain not reachable over HTTP/HTTPS", "collector": "http", "reason": "Connection refused or timed out", "impact": "Cannot assess web content, login forms, or redirect behavior"}]', 'external_context': 'null'}
2026-02-28 18:34:55,554 INFO sqlalchemy.engine.Engine INSERT INTO reports (id, investigation_id, iteration, report_json, executive_summary, technical_narrative, recommendations) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(iteration)s, %(report_json)s::JSONB, %(executive_summary)s, %(technical_narrative)s, %(recommendations)s) RETURNING reports.created_at
2026-02-28 18:34:55,555 INFO sqlalchemy.engine.Engine [cached since 4.546s ago] {'id': UUID('f80ff1d8-7f47-499c-b1df-d84f43abfbd1'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'iteration': 0, 'report_json': '{"classification": "inconclusive", "confidence": "low", "investigation_state": "insufficient_data", "primary_reasoning": "The domain b.com shows no D ... (14763 characters truncated) ... r OpenPhish and CT entries indicate real/active malicious hosting tied to b.com or are historical/misattributed.", "recommendations_narrative": null}', 'executive_summary': '- Investigated observable: domain b.com (domain investigation c370d33f-5b74-4172-9d94-96fafb372289). Focus: phishing, typosquatting, brand abuse, mal ... (801 characters truncated) ... e action: investigative data collection (passive DNS, OpenPhish artifacts, CT logs) and monitoring for DNS changes or mail traffic referencing b.com.', 'technical_narrative': 'Step 1 — Baseline plausibility (legitimate hypothesis)\n- Could a legitimate entity produce this observable? Yes. WHOIS indicates registrar RESERVED- ... (3668 characters truncated) ...  Data gaps prevent determining whether OpenPhish and CT entries indicate real/active malicious hosting tied to b.com or are historical/misattributed.', 'recommendations': None}
2026-02-28 18:34:55,559 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,560 INFO sqlalchemy.engine.Engine [cached since 4.541s ago] {'id': UUID('46fd2516-c532-41b3-baa0-6f3f95fef85b'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'asn', 'status': 'failed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 266, 'evidence_json': '{"meta": {"collector": "asn", "version": "1.0.0", "status": "failed", "started_at": "2026-02-28T16:33:11.412447Z", "completed_at": "2026-02-28T16:33: ... (203 characters truncated) ... tion": null, "country": null, "city": null, "is_cdn": null, "is_cloud": null, "is_hosting": null, "reverse_dns": null, "related_domains_same_ip": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,563 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,564 INFO sqlalchemy.engine.Engine [cached since 4.544s ago] {'id': UUID('6562bb9a-588f-43c0-8f34-335947bb3f54'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'tls', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 593, 'evidence_json': '{"meta": {"collector": "tls", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.409874Z", "completed_at": "2026-02-28T16: ... (241 characters truncated) ... ber": null, "signature_algorithm": null, "is_wildcard": null, "is_self_signed": null, "chain_length": null, "chain_issuers": [], "cert_sha256": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,566 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,567 INFO sqlalchemy.engine.Engine [cached since 4.547s ago] {'id': UUID('0104da4e-fd88-4190-a460-3a76061babe1'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'http', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 702, 'evidence_json': '{"meta": {"collector": "http", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.407345Z", "completed_at": "2026-02-28T16 ... (321 characters truncated) ... nput_fields": null, "technologies_detected": [], "security_headers": {}, "brand_indicators": [], "phishing_indicators": [], "external_resources": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,569 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,570 INFO sqlalchemy.engine.Engine [cached since 4.55s ago] {'id': UUID('9a155b4b-f0d0-4c94-817c-215250200ecc'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'dns', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 813, 'evidence_json': '{"meta": {"collector": "dns", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.404443Z", "completed_at": "2026-02-28T16: ... (119 characters truncated) ... 873c2f11161202b945"}, "records": [], "a": [], "aaaa": [], "cname": [], "mx": [], "ns": [], "txt": [], "dmarc": null, "spf": null, "has_dnssec": null}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,572 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,573 INFO sqlalchemy.engine.Engine [cached since 4.554s ago] {'id': UUID('27f90664-ebfd-4525-a543-af8991269e0a'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'whois', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 2656, 'evidence_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.411207Z", "completed_at": "2026-02-28T1 ... (531 characters truncated) ... ", "serverTransferProhibited https://icann.org/epp#serverTransferProhibited", "serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,577 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,579 INFO sqlalchemy.engine.Engine [cached since 4.56s ago] {'id': UUID('d0b0fc09-c1f7-45e6-8f9b-b57b3dfd7397'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'vt', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 3563, 'evidence_json': '{"meta": {"collector": "vt", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.651947Z", "completed_at": "2026-02-28T16:3 ... (9499 characters truncated) ... t_registrar": "RESERVED-Internet Assigned Numbers Authority", "tags": ["nxdomain", "potential-c2"], "notes": [], "file_name": null, "file_names": []}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,583 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,583 INFO sqlalchemy.engine.Engine [cached since 4.563s ago] {'id': UUID('b26d42dc-2932-4362-8e68-8c971ef527cc'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'threat_feeds', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 4233, 'evidence_json': '{"meta": {"collector": "threat_feeds", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.669381Z", "completed_at": "2026- ... (258 characters truncated) ... h_listed": true, "feeds_checked": ["phishtank", "openphish"], "feeds_skipped": ["abuseipdb (DNS resolution failed)", "threatfox (error: HTTPError)"]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,586 INFO sqlalchemy.engine.Engine INSERT INTO collector_results (id, investigation_id, collector_name, status, version, started_at, completed_at, duration_ms, evidence_json, error, raw_artifact_hash) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(collector_name)s, %(status)s, %(version)s, %(started_at)s, %(completed_at)s, %(duration_ms)s, %(evidence_json)s::JSONB, %(error)s, %(raw_artifact_hash)s)
2026-02-28 18:34:55,587 INFO sqlalchemy.engine.Engine [cached since 4.567s ago] {'id': UUID('ffc434ce-cfdc-4f6f-8775-a173fe9a6361'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'collector_name': 'intel', 'status': 'completed', 'version': '1.0.0', 'started_at': None, 'completed_at': None, 'duration_ms': 21889, 'evidence_json': '{"meta": {"collector": "intel", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.465934Z", "completed_at": "2026-02-28T1 ... (62333 characters truncated) ... ore": "2021-11-01T20:13:25", "not_after": "2022-01-30T20:13:24", "entry_timestamp": "2021-11-01T21:13:26.047", "name_value": "bridge.rss.i--b.com"}]}', 'error': None, 'raw_artifact_hash': None}
2026-02-28 18:34:55,594 INFO sqlalchemy.engine.Engine INSERT INTO iocs (id, investigation_id, type, value, context, confidence) VALUES (%(id)s::UUID, %(investigation_id)s::UUID, %(type)s, %(value)s, %(context)s, %(confidence)s) RETURNING iocs.created_at
2026-02-28 18:34:55,595 INFO sqlalchemy.engine.Engine [generated in 0.00105s] {'id': UUID('c1ef6f4f-6bf6-4629-bdcf-33d32401c55c'), 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'type': 'domain', 'value': 'b.com', 'context': 'Investigated domain; currently NXDOMAIN/unresolved; appears in OpenPhish feed per threat_feeds.openphish_listed', 'confidence': 'medium'}
2026-02-28 18:34:55,597 INFO sqlalchemy.engine.Engine SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = %(domain_1)s ORDER BY whois_history.captured_at DESC 
 LIMIT %(param_1)s
2026-02-28 18:34:55,598 INFO sqlalchemy.engine.Engine [cached since 4.519s ago] {'domain_1': 'b.com', 'param_1': 1}
2026-02-28 18:34:55,600 INFO sqlalchemy.engine.Engine INSERT INTO whois_history (id, domain, whois_json, investigation_id, changes_from_previous) VALUES (%(id)s::UUID, %(domain)s, %(whois_json)s::JSONB, %(investigation_id)s::UUID, %(changes_from_previous)s::JSONB) RETURNING whois_history.captured_at
2026-02-28 18:34:55,601 INFO sqlalchemy.engine.Engine [cached since 4.514s ago] {'id': UUID('b37b738e-feba-4ea0-93da-d22c16e2688a'), 'domain': 'b.com', 'whois_json': '{"meta": {"collector": "whois", "version": "1.0.0", "status": "completed", "started_at": "2026-02-28T16:33:11.411207Z", "completed_at": "2026-02-28T1 ... (531 characters truncated) ... ", "serverTransferProhibited https://icann.org/epp#serverTransferProhibited", "serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited"]}', 'investigation_id': UUID('c370d33f-5b74-4172-9d94-96fafb372289'), 'changes_from_previous': '{}'}
2026-02-28 18:34:55,603 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 18:34:55,606 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 18:34:55,607 INFO sqlalchemy.engine.Engine SELECT investigations.id AS investigations_id, investigations.domain AS investigations_domain, investigations.observable_type AS investigations_observable_type, investigations.state AS investigations_state, investigations.context AS investigations_context, investigations.client_domain AS investigations_client_domain, investigations.batch_id AS investigations_batch_id, investigations.created_at AS investigations_created_at, investigations.updated_at AS investigations_updated_at, investigations.concluded_at AS investigations_concluded_at, investigations.classification AS investigations_classification, investigations.confidence AS investigations_confidence, investigations.risk_score AS investigations_risk_score, investigations.recommended_action AS investigations_recommended_action, investigations.analyst_iterations AS investigations_analyst_iterations, investigations.max_analyst_iterations AS investigations_max_analyst_iterations 
FROM investigations 
WHERE investigations.id = %(pk_1)s::UUID
2026-02-28 18:34:55,609 INFO sqlalchemy.engine.Engine [cached since 4.502s ago] {'pk_1': UUID('c370d33f-5b74-4172-9d94-96fafb372289')}
2026-02-28 18:34:55,612 INFO sqlalchemy.engine.Engine SELECT clients.id, clients.name, clients.domain, clients.aliases, clients.brand_keywords, clients.contact_email, clients.notes, clients.status, clients.created_at, clients.alert_count, clients.last_alert_at, clients.default_collectors 
FROM clients 
WHERE clients.status = %(status_1)s
2026-02-28 18:34:55,614 INFO sqlalchemy.engine.Engine [cached since 4.5s ago] {'status_1': 'active'}
2026-02-28 18:34:55,617 INFO sqlalchemy.engine.Engine ROLLBACK
