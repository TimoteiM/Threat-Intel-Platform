[config] Loaded .env from: C:\Users\tmoscaliuc\Downloads\script\threat-investigator\threat-intel\backend\.env
[config] Settings loaded — VT key: SET
2026-02-28 17:10:19,293 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-02-28 17:10:19,298 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 17:10:19,303 INFO sqlalchemy.engine.Engine select current_schema()
2026-02-28 17:10:19,305 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 17:10:19,309 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-02-28 17:10:19,311 INFO sqlalchemy.engine.Engine [raw sql] ()
2026-02-28 17:10:19,314 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 17:10:19,321 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,322 INFO sqlalchemy.engine.Engine [generated in 0.00133s] ('batches', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,330 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,331 INFO sqlalchemy.engine.Engine [cached since 0.0104s ago] ('investigations', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,333 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,334 INFO sqlalchemy.engine.Engine [cached since 0.01352s ago] ('collector_results', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,335 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,337 INFO sqlalchemy.engine.Engine [cached since 0.01613s ago] ('evidence', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,338 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,339 INFO sqlalchemy.engine.Engine [cached since 0.01865s ago] ('reports', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,341 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,342 INFO sqlalchemy.engine.Engine [cached since 0.02189s ago] ('artifacts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,344 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,345 INFO sqlalchemy.engine.Engine [cached since 0.02461s ago] ('iocs', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,347 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,347 INFO sqlalchemy.engine.Engine [cached since 0.02696s ago] ('watchlist', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,349 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,350 INFO sqlalchemy.engine.Engine [cached since 0.02942s ago] ('watchlist_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,351 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,352 INFO sqlalchemy.engine.Engine [cached since 0.03187s ago] ('clients', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,353 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,354 INFO sqlalchemy.engine.Engine [cached since 0.03432s ago] ('client_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,355 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,357 INFO sqlalchemy.engine.Engine [cached since 0.03669s ago] ('whois_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,359 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,360 INFO sqlalchemy.engine.Engine [cached since 0.03933s ago] ('ip_lookups', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,361 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 17:10:19,362 INFO sqlalchemy.engine.Engine [cached since 0.04147s ago] ('lookup_cache', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 17:10:19,364 INFO sqlalchemy.engine.Engine ALTER TABLE clients ADD COLUMN IF NOT EXISTS default_collectors JSONB NOT NULL DEFAULT '[]'::jsonb
2026-02-28 17:10:19,364 INFO sqlalchemy.engine.Engine [generated in 0.00098s] ()
2026-02-28 17:10:19,368 INFO sqlalchemy.engine.Engine ALTER TABLE investigations ADD COLUMN IF NOT EXISTS observable_type VARCHAR(20) NOT NULL DEFAULT 'domain'
2026-02-28 17:10:19,369 INFO sqlalchemy.engine.Engine [generated in 0.00091s] ()
2026-02-28 17:10:19,371 INFO sqlalchemy.engine.Engine ALTER TABLE investigations ALTER COLUMN domain TYPE VARCHAR(512)
2026-02-28 17:10:19,372 INFO sqlalchemy.engine.Engine [generated in 0.00124s] ()
2026-02-28 17:10:19,378 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 17:10:22,528 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 17:10:22,562 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 17:10:22,565 INFO sqlalchemy.engine.Engine [generated in 0.00304s] (10, 0)
2026-02-28 17:10:22,571 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 17:10:22,572 INFO sqlalchemy.engine.Engine [generated in 0.00086s] ()
INFO:     127.0.0.1:57145 - "GET /api/investigations?limit=10 HTTP/1.1" 200 OK
2026-02-28 17:10:22,576 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 17:10:22,587 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 17:10:22,588 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 17:10:22,589 INFO sqlalchemy.engine.Engine [cached since 0.02774s ago] (10, 0)
2026-02-28 17:10:22,592 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 17:10:22,593 INFO sqlalchemy.engine.Engine [cached since 0.02114s ago] ()
INFO:     127.0.0.1:57148 - "GET /api/investigations?limit=10 HTTP/1.1" 200 OK
2026-02-28 17:10:22,673 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 17:10:22,678 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 17:10:22,681 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 17:10:22,684 INFO sqlalchemy.engine.Engine [cached since 0.1117s ago] ()
2026-02-28 17:10:22,697 INFO sqlalchemy.engine.Engine SELECT investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.state = $1::VARCHAR AND investigations.classification IS NOT NULL GROUP BY investigations.classification
2026-02-28 17:10:22,699 INFO sqlalchemy.engine.Engine [generated in 0.00270s] ('concluded',)
2026-02-28 17:10:22,706 INFO sqlalchemy.engine.Engine SELECT CASE WHEN (investigations.risk_score <= $1::INTEGER) THEN $2::VARCHAR WHEN (investigations.risk_score <= $3::INTEGER) THEN $4::VARCHAR WHEN (investigations.risk_score <= $5::INTEGER) THEN $6::VARCHAR WHEN (investigations.risk_score <= $7::INTEGER) THEN $8::VARCHAR ELSE $9::VARCHAR END AS bucket, count(*) AS count 
FROM investigations 
WHERE investigations.state = $10::VARCHAR AND investigations.risk_score IS NOT NULL GROUP BY bucket
2026-02-28 17:10:22,709 INFO sqlalchemy.engine.Engine [generated in 0.00185s] (20, '0-20', 40, '21-40', 60, '41-60', 80, '61-80', '81-100', 'concluded')
2026-02-28 17:10:22,716 INFO sqlalchemy.engine.Engine SELECT date_trunc($1::VARCHAR, investigations.created_at) AS day, investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.created_at >= $2::TIMESTAMP WITH TIME ZONE AND investigations.state = $3::VARCHAR GROUP BY day, investigations.classification ORDER BY day
2026-02-28 17:10:22,717 INFO sqlalchemy.engine.Engine [generated in 0.00151s] ('day', datetime.datetime(2026, 1, 29, 15, 10, 22, 713441, tzinfo=datetime.timezone.utc), 'concluded')
2026-02-28 17:10:22,723 INFO sqlalchemy.engine.Engine 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 17:10:22,724 INFO sqlalchemy.engine.Engine [generated in 0.00116s] ('whois', 'registrar', ['malicious', 'suspicious'], 10)
2026-02-28 17:10:22,744 INFO sqlalchemy.engine.Engine 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 17:10:22,746 INFO sqlalchemy.engine.Engine [cached since 0.0238s ago] ('hosting', 'asn_org', ['malicious', 'suspicious'], 10)
2026-02-28 17:10:22,761 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.risk_score, investigations.classification, investigations.created_at 
FROM investigations 
WHERE investigations.classification = $1::VARCHAR ORDER BY investigations.created_at DESC 
 LIMIT $2::INTEGER
2026-02-28 17:10:22,764 INFO sqlalchemy.engine.Engine [generated in 0.00272s] ('malicious', 10)
INFO:     127.0.0.1:57146 - "GET /api/dashboard/stats HTTP/1.1" 200 OK
2026-02-28 17:10:22,769 INFO sqlalchemy.engine.Engine COMMIT
2026-02-28 17:10:22,777 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-28 17:10:22,779 INFO sqlalchemy.engine.Engine SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 17:10:22,780 INFO sqlalchemy.engine.Engine [cached since 0.2081s ago] ()
2026-02-28 17:10:22,781 INFO sqlalchemy.engine.Engine SELECT investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.state = $1::VARCHAR AND investigations.classification IS NOT NULL GROUP BY investigations.classification
2026-02-28 17:10:22,783 INFO sqlalchemy.engine.Engine [cached since 0.08649s ago] ('concluded',)
2026-02-28 17:10:22,785 INFO sqlalchemy.engine.Engine SELECT CASE WHEN (investigations.risk_score <= $1::INTEGER) THEN $2::VARCHAR WHEN (investigations.risk_score <= $3::INTEGER) THEN $4::VARCHAR WHEN (investigations.risk_score <= $5::INTEGER) THEN $6::VARCHAR WHEN (investigations.risk_score <= $7::INTEGER) THEN $8::VARCHAR ELSE $9::VARCHAR END AS bucket, count(*) AS count 
FROM investigations 
WHERE investigations.state = $10::VARCHAR AND investigations.risk_score IS NOT NULL GROUP BY bucket
2026-02-28 17:10:22,786 INFO sqlalchemy.engine.Engine [cached since 0.0795s ago] (20, '0-20', 40, '21-40', 60, '41-60', 80, '61-80', '81-100', 'concluded')
2026-02-28 17:10:22,788 INFO sqlalchemy.engine.Engine SELECT date_trunc($1::VARCHAR, investigations.created_at) AS day, investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.created_at >= $2::TIMESTAMP WITH TIME ZONE AND investigations.state = $3::VARCHAR GROUP BY day, investigations.classification ORDER BY day
2026-02-28 17:10:22,788 INFO sqlalchemy.engine.Engine [cached since 0.0723s ago] ('day', datetime.datetime(2026, 1, 29, 15, 10, 22, 787399, tzinfo=datetime.timezone.utc), 'concluded')
2026-02-28 17:10:22,790 INFO sqlalchemy.engine.Engine 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 17:10:22,790 INFO sqlalchemy.engine.Engine [cached since 0.06803s ago] ('whois', 'registrar', ['malicious', 'suspicious'], 10)
2026-02-28 17:10:22,807 INFO sqlalchemy.engine.Engine 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 17:10:22,809 INFO sqlalchemy.engine.Engine [cached since 0.08703s ago] ('hosting', 'asn_org', ['malicious', 'suspicious'], 10)
2026-02-28 17:10:22,824 INFO sqlalchemy.engine.Engine SELECT investigations.id, investigations.domain, investigations.risk_score, investigations.classification, investigations.created_at 
FROM investigations 
WHERE investigations.classification = $1::VARCHAR ORDER BY investigations.created_at DESC 
 LIMIT $2::INTEGER
2026-02-28 17:10:22,826 INFO sqlalchemy.engine.Engine [cached since 0.06551s ago] ('malicious', 10)
INFO:     127.0.0.1:57149 - "GET /api/dashboard/stats HTTP/1.1" 200 OK
2026-02-28 17:10:22,831 INFO sqlalchemy.engine.Engine COMMIT
