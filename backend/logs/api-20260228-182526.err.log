INFO:     Started server process [115476]
INFO:     Waiting for application startup.
2026-02-28 18:25:34,401 INFO     [sqlalchemy.engine.Engine] select pg_catalog.version()
2026-02-28 18:25:34,405 INFO     [sqlalchemy.engine.Engine] [raw sql] ()
2026-02-28 18:25:34,409 INFO     [sqlalchemy.engine.Engine] select current_schema()
2026-02-28 18:25:34,411 INFO     [sqlalchemy.engine.Engine] [raw sql] ()
2026-02-28 18:25:34,414 INFO     [sqlalchemy.engine.Engine] show standard_conforming_strings
2026-02-28 18:25:34,417 INFO     [sqlalchemy.engine.Engine] [raw sql] ()
2026-02-28 18:25:34,420 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:25:34,424 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,424 INFO     [sqlalchemy.engine.Engine] [generated in 0.00076s] ('batches', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,434 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,435 INFO     [sqlalchemy.engine.Engine] [cached since 0.01058s ago] ('investigations', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,438 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,438 INFO     [sqlalchemy.engine.Engine] [cached since 0.01394s ago] ('collector_results', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,441 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,441 INFO     [sqlalchemy.engine.Engine] [cached since 0.01693s ago] ('evidence', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,443 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,445 INFO     [sqlalchemy.engine.Engine] [cached since 0.0199s ago] ('reports', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,446 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,448 INFO     [sqlalchemy.engine.Engine] [cached since 0.02344s ago] ('artifacts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,450 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,451 INFO     [sqlalchemy.engine.Engine] [cached since 0.02748s ago] ('iocs', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,453 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,453 INFO     [sqlalchemy.engine.Engine] [cached since 0.02929s ago] ('watchlist', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,455 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,455 INFO     [sqlalchemy.engine.Engine] [cached since 0.03121s ago] ('watchlist_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,456 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,457 INFO     [sqlalchemy.engine.Engine] [cached since 0.03305s ago] ('clients', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,458 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,459 INFO     [sqlalchemy.engine.Engine] [cached since 0.03471s ago] ('client_alerts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,460 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,461 INFO     [sqlalchemy.engine.Engine] [cached since 0.03633s ago] ('whois_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,462 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,463 INFO     [sqlalchemy.engine.Engine] [cached since 0.03886s ago] ('ip_lookups', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,465 INFO     [sqlalchemy.engine.Engine] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-28 18:25:34,466 INFO     [sqlalchemy.engine.Engine] [cached since 0.0415s ago] ('lookup_cache', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-28 18:25:34,468 INFO     [sqlalchemy.engine.Engine] ALTER TABLE clients ADD COLUMN IF NOT EXISTS default_collectors JSONB NOT NULL DEFAULT '[]'::jsonb
2026-02-28 18:25:34,468 INFO     [sqlalchemy.engine.Engine] [generated in 0.00070s] ()
2026-02-28 18:25:34,472 INFO     [sqlalchemy.engine.Engine] ALTER TABLE investigations ADD COLUMN IF NOT EXISTS observable_type VARCHAR(20) NOT NULL DEFAULT 'domain'
2026-02-28 18:25:34,472 INFO     [sqlalchemy.engine.Engine] [generated in 0.00065s] ()
2026-02-28 18:25:34,474 INFO     [sqlalchemy.engine.Engine] ALTER TABLE investigations ALTER COLUMN domain TYPE VARCHAR(512)
2026-02-28 18:25:34,475 INFO     [sqlalchemy.engine.Engine] [generated in 0.00059s] ()
2026-02-28 18:25:34,481 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:25:34,483 INFO     [app.main] Database schema verified / migrated
2026-02-28 18:25:34,483 INFO     [app.main] Threat Investigation Platform starting
2026-02-28 18:25:34,484 INFO     [app.main] Environment: development
2026-02-28 18:25:34,484 INFO     [app.main] Analyst model: gpt-5-mini
2026-02-28 18:25:34,484 INFO     [app.main] Claude fallback: enabled (model=claude-sonnet-4-20250514)
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8010 (Press CTRL+C to quit)
2026-02-28 18:25:34,908 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:25:34,932 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:25:34,934 INFO     [sqlalchemy.engine.Engine] [generated in 0.00164s] (1, 0)
2026-02-28 18:25:34,944 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:25:34,945 INFO     [sqlalchemy.engine.Engine] [generated in 0.00082s] ()
2026-02-28 18:25:34,948 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,428 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,437 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:26:21,440 INFO     [sqlalchemy.engine.Engine] [generated in 0.00305s] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,489 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,573 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,577 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:26:21,579 INFO     [sqlalchemy.engine.Engine] [cached since 0.142s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,583 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,595 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,598 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:26:21,600 INFO     [sqlalchemy.engine.Engine] [cached since 0.1632s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,605 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,820 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,824 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:26:21,826 INFO     [sqlalchemy.engine.Engine] [cached since 0.3889s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,830 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,835 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:26:21,836 INFO     [sqlalchemy.engine.Engine] [generated in 0.00181s] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,863 INFO     [sqlalchemy.engine.Engine] ROLLBACK
2026-02-28 18:26:21,867 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,892 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,896 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:26:21,899 INFO     [sqlalchemy.engine.Engine] [cached since 0.06457s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:21,912 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:21,916 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:26:21,918 INFO     [sqlalchemy.engine.Engine] [generated in 0.00187s] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'), 1)
2026-02-28 18:26:21,942 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,954 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:21,995 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:22,001 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:26:22,003 INFO     [sqlalchemy.engine.Engine] [cached since 0.1686s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'),)
2026-02-28 18:26:22,033 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:22,041 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:22,044 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:26:22,046 INFO     [sqlalchemy.engine.Engine] [cached since 0.1298s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'), 1)
2026-02-28 18:26:22,052 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:26:22,076 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:26:22,080 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:26:22,082 INFO     [sqlalchemy.engine.Engine] [cached since 0.1665s ago] (UUID('c400f839-2bc7-4f4e-b1fe-ca9a24b96fcc'), 1)
2026-02-28 18:26:22,092 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:16,056 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:16,060 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:27:16,063 INFO     [sqlalchemy.engine.Engine] [cached since 101.1s ago] (10, 0)
2026-02-28 18:27:16,094 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:16,103 INFO     [sqlalchemy.engine.Engine] [cached since 101.2s ago] ()
2026-02-28 18:27:16,196 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:16,201 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:16,213 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:16,215 INFO     [sqlalchemy.engine.Engine] [cached since 101.3s ago] ()
2026-02-28 18:27:16,249 INFO     [sqlalchemy.engine.Engine] SELECT investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.state = $1::VARCHAR AND investigations.classification IS NOT NULL GROUP BY investigations.classification
2026-02-28 18:27:16,262 INFO     [sqlalchemy.engine.Engine] [generated in 0.01428s] ('concluded',)
2026-02-28 18:27:16,277 INFO     [sqlalchemy.engine.Engine] SELECT CASE WHEN (investigations.risk_score <= $1::INTEGER) THEN $2::VARCHAR WHEN (investigations.risk_score <= $3::INTEGER) THEN $4::VARCHAR WHEN (investigations.risk_score <= $5::INTEGER) THEN $6::VARCHAR WHEN (investigations.risk_score <= $7::INTEGER) THEN $8::VARCHAR ELSE $9::VARCHAR END AS bucket, count(*) AS count 
FROM investigations 
WHERE investigations.state = $10::VARCHAR AND investigations.risk_score IS NOT NULL GROUP BY bucket
2026-02-28 18:27:16,295 INFO     [sqlalchemy.engine.Engine] [generated in 0.01829s] (20, '0-20', 40, '21-40', 60, '41-60', 80, '61-80', '81-100', 'concluded')
2026-02-28 18:27:16,330 INFO     [sqlalchemy.engine.Engine] SELECT date_trunc($1::VARCHAR, investigations.created_at) AS day, investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.created_at >= $2::TIMESTAMP WITH TIME ZONE AND investigations.state = $3::VARCHAR GROUP BY day, investigations.classification ORDER BY day
2026-02-28 18:27:16,352 INFO     [sqlalchemy.engine.Engine] [generated in 0.02137s] ('day', datetime.datetime(2026, 1, 29, 16, 27, 16, 323618, tzinfo=datetime.timezone.utc), 'concluded')
2026-02-28 18:27:16,374 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:16,377 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:27:16,378 INFO     [sqlalchemy.engine.Engine] [cached since 101.4s ago] (10, 0)
2026-02-28 18:27:16,382 INFO     [sqlalchemy.engine.Engine] 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 18:27:16,401 INFO     [sqlalchemy.engine.Engine] [generated in 0.01928s] ('whois', 'registrar', ['malicious', 'suspicious'], 10)
2026-02-28 18:27:16,484 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:16,488 INFO     [sqlalchemy.engine.Engine] [cached since 101.5s ago] ()
2026-02-28 18:27:16,493 INFO     [sqlalchemy.engine.Engine] 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 18:27:16,578 INFO     [sqlalchemy.engine.Engine] [cached since 0.1966s ago] ('hosting', 'asn_org', ['malicious', 'suspicious'], 10)
2026-02-28 18:27:16,587 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:16,624 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.risk_score, investigations.classification, investigations.created_at 
FROM investigations 
WHERE investigations.classification = $1::VARCHAR ORDER BY investigations.created_at DESC 
 LIMIT $2::INTEGER
2026-02-28 18:27:16,676 INFO     [sqlalchemy.engine.Engine] [generated in 0.05291s] ('malicious', 10)
2026-02-28 18:27:16,721 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:16,828 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:16,830 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:16,831 INFO     [sqlalchemy.engine.Engine] [cached since 101.9s ago] ()
2026-02-28 18:27:16,835 INFO     [sqlalchemy.engine.Engine] SELECT investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.state = $1::VARCHAR AND investigations.classification IS NOT NULL GROUP BY investigations.classification
2026-02-28 18:27:16,837 INFO     [sqlalchemy.engine.Engine] [cached since 0.5884s ago] ('concluded',)
2026-02-28 18:27:16,844 INFO     [sqlalchemy.engine.Engine] SELECT CASE WHEN (investigations.risk_score <= $1::INTEGER) THEN $2::VARCHAR WHEN (investigations.risk_score <= $3::INTEGER) THEN $4::VARCHAR WHEN (investigations.risk_score <= $5::INTEGER) THEN $6::VARCHAR WHEN (investigations.risk_score <= $7::INTEGER) THEN $8::VARCHAR ELSE $9::VARCHAR END AS bucket, count(*) AS count 
FROM investigations 
WHERE investigations.state = $10::VARCHAR AND investigations.risk_score IS NOT NULL GROUP BY bucket
2026-02-28 18:27:16,865 INFO     [sqlalchemy.engine.Engine] [cached since 0.5878s ago] (20, '0-20', 40, '21-40', 60, '41-60', 80, '61-80', '81-100', 'concluded')
2026-02-28 18:27:16,901 INFO     [sqlalchemy.engine.Engine] SELECT date_trunc($1::VARCHAR, investigations.created_at) AS day, investigations.classification, count(*) AS count 
FROM investigations 
WHERE investigations.created_at >= $2::TIMESTAMP WITH TIME ZONE AND investigations.state = $3::VARCHAR GROUP BY day, investigations.classification ORDER BY day
2026-02-28 18:27:16,910 INFO     [sqlalchemy.engine.Engine] [cached since 0.5803s ago] ('day', datetime.datetime(2026, 1, 29, 16, 27, 16, 881501, tzinfo=datetime.timezone.utc), 'concluded')
2026-02-28 18:27:16,918 INFO     [sqlalchemy.engine.Engine] 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 18:27:16,932 INFO     [sqlalchemy.engine.Engine] [cached since 0.5499s ago] ('whois', 'registrar', ['malicious', 'suspicious'], 10)
2026-02-28 18:27:16,975 INFO     [sqlalchemy.engine.Engine] 
                SELECT
                    e.evidence_json->$1->>$2 AS field_value,
                    COUNT(*) AS count
                FROM evidence e
                JOIN investigations i ON i.id = e.investigation_id
                WHERE i.classification = ANY($3)
                  AND i.state = 'concluded'
                  AND e.evidence_json->$1->>$2 IS NOT NULL
                  AND e.evidence_json->$1->>$2 != ''
                GROUP BY field_value
                ORDER BY count DESC
                LIMIT $4
            
2026-02-28 18:27:16,977 INFO     [sqlalchemy.engine.Engine] [cached since 0.5952s ago] ('hosting', 'asn_org', ['malicious', 'suspicious'], 10)
2026-02-28 18:27:17,018 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.risk_score, investigations.classification, investigations.created_at 
FROM investigations 
WHERE investigations.classification = $1::VARCHAR ORDER BY investigations.created_at DESC 
 LIMIT $2::INTEGER
2026-02-28 18:27:17,021 INFO     [sqlalchemy.engine.Engine] [cached since 0.3971s ago] ('malicious', 10)
2026-02-28 18:27:17,057 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:25,791 INFO     [httpx] HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2026-02-28 18:27:27,885 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:27,888 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:27:27,890 INFO     [sqlalchemy.engine.Engine] [cached since 113s ago] (10, 0)
2026-02-28 18:27:27,895 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:27,896 INFO     [sqlalchemy.engine.Engine] [cached since 113s ago] ()
2026-02-28 18:27:27,901 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:27,916 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:27,919 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:27:27,921 INFO     [sqlalchemy.engine.Engine] [cached since 113s ago] (10, 0)
2026-02-28 18:27:27,924 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:27,924 INFO     [sqlalchemy.engine.Engine] [cached since 113s ago] ()
2026-02-28 18:27:27,930 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:34,864 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:34,865 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations ORDER BY investigations.created_at DESC 
 LIMIT $1::INTEGER OFFSET $2::INTEGER
2026-02-28 18:27:34,866 INFO     [sqlalchemy.engine.Engine] [cached since 119.9s ago] (10, 10)
2026-02-28 18:27:34,871 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations
2026-02-28 18:27:34,872 INFO     [sqlalchemy.engine.Engine] [cached since 119.9s ago] ()
2026-02-28 18:27:34,877 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:37,095 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:37,102 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.domain ILIKE $1::VARCHAR ORDER BY investigations.created_at DESC 
 LIMIT $2::INTEGER OFFSET $3::INTEGER
2026-02-28 18:27:37,105 INFO     [sqlalchemy.engine.Engine] [generated in 0.00493s] ('%adida%', 10, 0)
2026-02-28 18:27:37,117 INFO     [sqlalchemy.engine.Engine] SELECT count(investigations.id) AS count_1 
FROM investigations 
WHERE investigations.domain ILIKE $1::VARCHAR
2026-02-28 18:27:37,120 INFO     [sqlalchemy.engine.Engine] [generated in 0.00243s] ('%adida%',)
2026-02-28 18:27:37,128 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:38,910 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:38,913 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:27:38,914 INFO     [sqlalchemy.engine.Engine] [cached since 77.48s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:38,922 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:38,931 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:38,932 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:27:38,933 INFO     [sqlalchemy.engine.Engine] [cached since 77.5s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:38,939 INFO     [sqlalchemy.engine.Engine] ROLLBACK
2026-02-28 18:27:38,946 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:38,947 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:27:38,948 INFO     [sqlalchemy.engine.Engine] [cached since 77.51s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:38,956 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:38,962 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:38,963 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:27:38,964 INFO     [sqlalchemy.engine.Engine] [cached since 77.13s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:38,989 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,002 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,004 INFO     [sqlalchemy.engine.Engine] SELECT investigations.id, investigations.domain, investigations.observable_type, investigations.state, investigations.context, investigations.client_domain, investigations.batch_id, investigations.created_at, investigations.updated_at, investigations.concluded_at, investigations.classification, investigations.confidence, investigations.risk_score, investigations.recommended_action, investigations.analyst_iterations, investigations.max_analyst_iterations 
FROM investigations 
WHERE investigations.id = $1::UUID
2026-02-28 18:27:39,005 INFO     [sqlalchemy.engine.Engine] [cached since 77.57s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:39,010 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,018 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,019 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:27:39,021 INFO     [sqlalchemy.engine.Engine] [cached since 77.19s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:39,051 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,056 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:27:39,059 INFO     [sqlalchemy.engine.Engine] [cached since 77.14s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'), 1)
2026-02-28 18:27:39,066 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,075 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,085 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,086 INFO     [sqlalchemy.engine.Engine] SELECT evidence.id, evidence.investigation_id, evidence.evidence_json, evidence.signals, evidence.data_gaps, evidence.external_context, evidence.created_at 
FROM evidence 
WHERE evidence.investigation_id = $1::UUID
2026-02-28 18:27:39,088 INFO     [sqlalchemy.engine.Engine] [cached since 77.25s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'),)
2026-02-28 18:27:39,102 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,112 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,116 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:27:39,117 INFO     [sqlalchemy.engine.Engine] [cached since 77.2s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'), 1)
2026-02-28 18:27:39,123 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:39,153 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:39,156 INFO     [sqlalchemy.engine.Engine] SELECT reports.id, reports.investigation_id, reports.iteration, reports.report_json, reports.executive_summary, reports.technical_narrative, reports.recommendations, reports.created_at 
FROM reports 
WHERE reports.investigation_id = $1::UUID ORDER BY reports.iteration DESC 
 LIMIT $2::INTEGER
2026-02-28 18:27:39,160 INFO     [sqlalchemy.engine.Engine] [cached since 77.24s ago] (UUID('6d6e8daf-9d70-4d21-81cc-0c7e1cdd5b3c'), 1)
2026-02-28 18:27:39,168 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:56,126 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:56,129 INFO     [sqlalchemy.engine.Engine] SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = $1::VARCHAR ORDER BY whois_history.captured_at DESC
2026-02-28 18:27:56,130 INFO     [sqlalchemy.engine.Engine] [generated in 0.00099s] ('adidas-samba.de',)
2026-02-28 18:27:56,136 INFO     [sqlalchemy.engine.Engine] COMMIT
2026-02-28 18:27:56,147 INFO     [sqlalchemy.engine.Engine] BEGIN (implicit)
2026-02-28 18:27:56,148 INFO     [sqlalchemy.engine.Engine] SELECT whois_history.id, whois_history.domain, whois_history.whois_json, whois_history.captured_at, whois_history.investigation_id, whois_history.changes_from_previous 
FROM whois_history 
WHERE whois_history.domain = $1::VARCHAR ORDER BY whois_history.captured_at DESC
2026-02-28 18:27:56,149 INFO     [sqlalchemy.engine.Engine] [cached since 0.01996s ago] ('adidas-samba.de',)
2026-02-28 18:27:56,157 INFO     [sqlalchemy.engine.Engine] COMMIT
